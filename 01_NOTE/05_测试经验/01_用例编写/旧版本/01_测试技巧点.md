# 前置条件

```
任何需求，或者优化点等等都需要写案例【防止追溯】
任何需求，涉及到数据的，全都造数验证下【以防无数据的情况】
```



# 测试建议

## **项目理解--到快速上手**

- **应用层【最基础】**
  - 理解每个模块是做什么的（需求文档！）、用户怎么操作、它应该展现什么数据或产生什么结果
- **关键数据流**
  - 设备数据如何一步步最终展示在“监控管理”或“实时监控”页面上？
  - 用户在“配置管理”下发的指令如何一步步到达设备？
  - 一个设备告警是如何触发，并最终在“告警管理”显示，并被“告警处理”的？
  - 报表分析的数据来源是哪里？（实时库？离线分析结果？）
- **接口**
  - **设备接入协议 (`TCP-C`, `B接口`, `MQTT`, `CoAP`):** 了解基本概念，知道测试时需要模拟这些协议的设备来验证接入和数据上报。
  - **服务间API：** 应用层调用了哪些下层服务的API？了解这些API的文档（如果有），对进行集成测试、Mock测试很有帮助。
  - **第三方系统接口 (`视频NVR`, `门禁GES`, `第三方SC`):** 了解集成了哪些外部系统，测试时需要关注这些集成的稳定性和数据一致性。
- **理解核心流程**
  - 优先测试**设备接入->数据上报->实时监控/告警触发->告警处理** 这条最高优先级的闭环流程。
  - 然后是**配置下发->设备执行->状态反馈**流程。再扩展到其他管理功能和报表。

## 微服务理解

- **Zuul/Eureka, Config Server, Mycat, 统一认证：**
  - **定位：** 这些是**应用层面**或**平台中间件层面**的组件，解决微服务架构内部的特定问题：
    - **Zuul/Eureka:** 服务治理的核心（服务发现、负载均衡、动态路由、网关功能）。
    - **Config Server:** 集中化的、动态的外部化配置管理（避免配置文件散落在各个微服务中）。
    - **Mycat:** 数据库访问代理，解决数据库层面的扩展性问题（读写分离、分库分表）。
    - **统一认证:** 解决微服务之间或对外API访问的身份认证和授权问题。
  - **特点：** 通常由应用开发团队或平台中间件团队负责部署、维护和集成到应用中（例如，Spring Cloud应用需要添加Eureka Client依赖）。它们是运行在JVM上的应用本身（或为应用提供支撑的服务）
- **Kubernetes：**
  - **定位：** 这是**容器编排平台**，属于**基础设施层**。
  - **职责：**
    - **容器化应用的部署、调度和管理：** 自动将你的应用（打包成Docker镜像）部署到集群节点上，并根据资源需求和策略（如高可用、负载均衡）管理它们的生命周期（启动、停止、重启、伸缩）。
    - **服务发现与负载均衡：** Kubernetes内置了强大的**Service**和**Ingress**机制。
    - **Service:** 为一组功能相同的Pod（你的微服务实例）提供稳定的网络端点（ClusterIP, NodePort, LoadBalancer）和负载均衡。
    - **Ingress:** 提供集群外部的HTTP/HTTPS路由到内部Service的规则，是**网关**角色（功能上可以替代Zuul）。K8s的服务发现通过DNS和Service名即可完成，**可以替代Eureka**。
    - **配置管理：** 提供了**ConfigMap**和**Secret**对象，用于存储非敏感的配置数据和敏感数据（密码、密钥）。它们可以被挂载到Pod中作为文件或环境变量使用，**可以替代或简化Config Server的部分职责**（尤其在配置相对静态或不需要复杂加密的场景）。
    - **存储编排：** 管理有状态应用（如数据库）所需的持久化存储。
    - **自动伸缩：** 根据CPU、内存等指标或自定义指标自动伸缩Pod数量（Horizontal Pod Autoscaler）。
    - **自愈：** 自动重启失败的容器、替换不可达节点上的Pod、杀死不健康的Pod等。
  - **特点：** 由基础设施/运维团队管理，为应用提供运行环境和平台能力。它关注的是“如何可靠、高效地运行容器”。
- **CI/CD：**
  - **定位：** 这是一套**自动化流程和实践**，贯穿应用开发的整个生命周期（从代码提交到生产部署）。
  - **职责：**
    - **持续集成：** 自动构建代码、运行单元测试、集成测试，确保代码变更能快速、安全地合并到主干。
    - **持续交付/部署：** 自动将通过测试的代码构建成可部署的产物（如Docker镜像），并将其部署到各种环境（测试、预生产、生产）。对于K8s，这通常意味着将镜像部署到K8s集群（更新Deployment）。
  - **与上述组件的关系：**
    - 构建内容： CI/CD流水线负责构建包含了你应用的代码以及应用所需中间件客户端逻辑（如Eureka Client, Config Client）的Docker镜像。
    - 配置注入： CI/CD流水线（或部署工具如Helm, Argo CD）负责将K8s ConfigMap/Secret中的配置注入到应用容器中，或者将Config Server的地址/凭证传递给应用容器。
    - 部署到K8s： CI/CD流水线的最终步骤通常是调用K8s API（通过`kubectl`, Helm, Operator等），使用构建好的镜像和定义好的K8s资源清单（Deployment, Service, Ingress, ConfigMap等）来部署或更新应用。
    - 部署中间件本身： Zuul/Eureka, Config Server, Mycat这些中间件组件本身也需要部署和管理。在云原生环境下，它们通常也会被容器化，并通过CI/CD流水线部署到K8s集群中运行。例如，你会有一个专门部署Eureka Server的Deployment和Service。
  - **总结关系**
    - Zuul/Eureka, Config Server, Mycat, 统一认证： 是解决微服务架构内部问题（服务治理、配置、数据访问、安全）的应用/中间件组件。
    - Kubernetes： 是运行这些容器化应用和中间件组件的基础设施平台，并原生提供了部分重叠的能力（服务发现、负载均衡、基础配置管理、网关入口），使得部分传统组件（尤其是Eureka, Zuul）可能变得不必要或角色弱化。
    - CI/CD： 是实现将应用代码、中间件组件以及它们在K8s上的运行配置（资源清单、ConfigMap/Secret）自动化构建、测试和部署到K8s集群的关键流程。它连接了开发、中间件和基础设施层。
  - **简单总结**
    - 你开发的微服务应用（包含必要的客户端逻辑）和那些中间件（Zuul/Eureka, Config Server, Mycat, 统一认证服务）被打包成Docker镜像。
    - CI/CD流水线负责构建这些镜像，并定义好它们在K8s中如何运行（需要多少副本、如何配置、如何暴露服务、如何访问数据库/其他服务）。
    - Kubernetes负责接收CI/CD的指令，在集群中实际调度和运行这些容器，并提供平台级的服务发现、负载均衡、配置注入（通过ConfigMap/Secret）、网关入口（Ingress）、自愈、伸缩等能力。
    - K8s内置的能力可能替代或简化了部分传统微服务组件（如Eureka, Zuul）的角色，但像Mycat（分库分表）和统一认证（业务安全）这样的组件，其核心功能与K8s无关，仍需部署在K8s内或外，并由K8s管理其生命周期或提供访问路径

# 综合方面【❤重点】

## 公共点

- **❤测试分层【重点】**
  - 在卓望测试中，需要保持一个思路【公司系统是微服务的架构】
  - 首先：在界面功能验证的时候，如果出现问题，首先是F12看请求状态【判断状态码，请求参数等并且有无相应】
  - 其次：在上述无法定位到的时候，需要到服务器去排查【这里就涉及到微服务的概念，需要找到对应服务名--到CICD中流水线或环境中看日志】
  - 紧接：对于服务的涉及点，可以在提测内容中会说明
    - 模块：前端，后端（composite，water）
      - 在CICD中定位：项目名-spider【动环】 -- 组件名称【前端web、h5、bpm-web；后端kernel】 -- 【流水线 -- 即模块名】
      - 后端或前端上传后，直接在流水线构建打包即可
      - 一般选后端的构建详情
        - 跳转到所部署的环境中，pod实例，pod ip就是这个实例的ip【后端ip】，node ip【应该是前端】，查日志也是查这个ip
    - 分支：前端，后端（dev的都是前端；develop都是后端）
  - 根据对应的微服务，进到服务器中，pod
- **分层定位**
  - 应用层某个功能（如监控不到数据）出问题时
  - 应用层界面问题？ -> 测前端
  - 应用层调服务层API失败？ -> 测API接口
  - 服务层调数据处理层没结果？ -> 查Kafka消费、查数据库/ES
  - 数据处理层没收到数据？ -> 查Kafka生产、查接入层
  - 接入层没收到设备数据？ -> 查设备状态、网络、协议
- **判断数据(同步器构建的数据)是否能正确被生成、且运算方式是否正确**
  - 首先先在页面确保是否是无数据、且不展示【接口返回也是无数据】
  - 到数据库确保请求对应点时间点/或是条件点下也无数据
  - 通过在服务器调用同步器、需要同时查看日志信息【rancher中】、确保触发后日志正常
- ❤**bug的提交说明**【重点 】
  - 把请求参数 - 
  - 对应响应内容
  - 数据库查询记录
  - 如果涉及定时器
    - 复现结果写实际情况、附带es截图
    - 结果就是页面目前的效果
    - 期望就要带上curl定时器连接、达到的效果，页面的效果

  - 如果涉及逻辑问题
    - 步骤：提交当前页面显示逻辑
    - 期望：提交ui图和需求文档要求内容

  - 如果涉及到请求、响应400，内部错误的问题
    - 步骤：提交目前页面400错误的截图、以及请求的参数
    - 结果：提交k8s对应服务中收到的日志信息

- ❤**特殊情景**
  - 开发打包重新部署后，页面无变化【可能是缓存还保留的之前的，没有更新，需要清除缓存】
- **❤前端后bug定位技巧(同时精准定位)**
  - ❤**前端**【**API 请求前**（参数生成）→ **前端责任**】
    - **谁离用户更近**：前端问题【用户直接看到/操作的问题 】
    - **Network** 检查请求是否发出、参数是否正确【若请求正常但响应数据错误，则可能是后端问题】
    - **Console** 查看 JS 报错
    - 页面渲染问题【布局错乱、样式异常、图片/图标未加载、路径错误、资源缺失】
    - 用户交互逻辑【按钮点击无响应、表单验证失败、页面跳转错误】
    - 动态内容逻辑【数据展示错误-如果接口返回正确前提下，但是展示错误】
    - 动态内容逻辑【前端计算错误】
    - 网络请求层问题【API 请求未发送  - 看请求是否200、请求参数格式错误】
    - 页面加载空白【先看 Network：若 HTML 未加载（前端部署故障）】
    - 表单提交失败【前端：未做必填校验；】
    - 图片上传后无法显示【前端负责上传请求、请求成功则不关前端】
    - 用户登录后权限丢失【前端存储 token、如果没token就是前端】
    - 文件下载无数据【请求未发送、有数据但文件损坏、下载逻辑或blob转换错误】
    - 接口405访问方式错误，无返回结果【可能是前端发起请求缺失了】
    - 开发修复完成，浏览器1正常用，浏览器2接口为变化【浏览器缓存未清情况，用着之前的内容】
    - 前端切换展示、不如现在在A，且到B时，编辑或是信息还是展示这A的东西，接口的数据也是A的数据，那这个就是缓存问题【具体为什么是前端，待补充】
  - ❤**后端**【**API 请求后**（数据处理、响应）→ **后端责任**】
    - **谁离数据更近**：后端问题【数据存储、计算、安全相关】
    - 查看服务端日志（如 `logs/error.log`），定位报错堆栈信息
    - 直接测试 API：用 **Postman** 发送请求，若返回错误则问题在后端
    - 数据库监控：检查慢查询日志或连接池状态
    - API 接口故障【接口返回 500 错误、响应数据缺失字段】
    - 业务逻辑错误【下单时库存未扣减、权限校验失败】
    - 数据库操作问题【数据未保存（SQL 语句执行失败）】
    - 数据库操作问题【查询结果错误（如 `SELECT * FROM users` 返回空）】
    - 性能与安全【接口响应慢（数据库查询未优化）、SQL 注入漏洞】
    - 第三方服务集成【支付回调失败、短信发送异常】
    - 页面加载空白【先看 Network：若 API 返回 404（后端路由错误）】
    - 表单提交失败【后端：提交后数据验证失败（如用户名重复）】
    - 图片上传后无法显示【后端需保存文件并返回正确 URL、如果错误就是后端错】
    - 用户登录后权限丢失【后端需校验 token 有效性（如 JWT 过期校验未实现）】
    - 文件下载无数据【请求成功状态码错误、请求成功content-longth或数据为空、Postman 直接请求下载接口，若仍返回空文件 → 确认为后端问题】
    - 接口403权限问题，是后端的权限判断出现了问题
    - 特殊字符校验错误，可能是服务器白名单设置问题 - url配置
    - 页面访问一致是404错误 ，有可能是后端包不兼容【如上海的composite - 请求后，日志中看到404 not found】



# 功能方面

## 公共点

- 页面切换 -- 数据应有缓存 -- 不会一致初始化
- 搜索条件下 -- 内容需要根据条件进行变更
- 数据准确性  --  即验证计算的逻辑 -- 每个点对应的数据是否准确 -- 取值是否正确【测一两个即可 - 都是统一接口 - 同功能时】

## 可视化大屏/图表

- 柱状图、饼图、折线图、仪表盘等
- **前端点：**标题、数据字段、默认展示明晰、数据与线的个数一致、数据与线与标注一致【会受数据库数据影响】，空值、增减趋势，页面切换【是否存在重复初始化】、地图跳转【所传递过去的参数是否与需求一致，返回结果是否一致】，条件变更【所对应标题、数据，字段都需要一致】
- **后端点：**数据准确性【受其他数据影响--根据其他数据条件进行判断】、数据计算逻辑【验证接口返回数据与数据库一致，数据库可能受ES中间库影响--后端处理会取ES数据同步到mysql历史表】，数据小数点问题

## 报表

- 报表【无需触发器 - 无需写入es形式】
  - 前置条件：
    - 如果有设置搜索框、条件筛选等情况、需要验证条件改变下前端点和后端点都需要改变

  - 前端点：
    - 字段展示

  - 后端点：
    - ❤技巧：可以直接在界面就可以验证数据【比如A表统计数据，B表中可以看到】
    - 数据计算正确、 接口返回数据正确【即该点请求的数据与响应数据的关系是对应的 - 且取数据也是正确的】，数据库与界面数据一致
    - 文件导出是否增加该点【并且数据一致】
    - 该页面如果涉及多层次，那么所有层级下都增加该字段，并且导出结果都应该增加








# 接口方面

## 公共点

- **快速创建请求**
  - F12抓取接口 -- 右键接口 -- copy -- copy as curl(cmd/base)   【curl形式】
  - 直接复制到postman请求栏，会自动填充，并且发起请求
- **登录请求**
  - 通过cookies即可解决
- **参数请求对应要求**
  - parmas
  - data
  - json：需要使用content-type = application/json
  - file

## 水平越权

- 涉及到登录【使用cookies】
- 验证同等级下，有权限访问和无权限访问的对比

## 垂直越权

- 涉及到登录【使用cookies】
- 验证资源权限不同时，是否可以越权访问【访问到不属于自己的资源】