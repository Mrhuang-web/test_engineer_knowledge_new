# 机柜【B接口类】

- 【机柜管理-单机柜分析-温湿度报表】

## 业务逻辑【需求概述】

- 检测设备测点的供电情况，以及温度湿度的历史和实时状况，每隔5分钟对fsu采集数据进行取值，历史数据保留且展示的时间段
- 厂家每15分钟会传输数据到fsu[扩大检索范围]
- 定时器触发规律
  - 每十分钟统计一次，整点触发，每次触发取一小时段的数据，并分12个点
  - 每个点取值，取前后15分钟，距离该点时间最近的作为该点数据

## 涉及库表

- 公共表：
  - 测点编码表：t_cfg_metemodel_detail
  - 测点编码模板：t_cfg_metemodel
  - 字典查询：t_cfg_dict

- energy_cabinet_attribute_config：找设备和测点编码【用于在页面监控视图看实时数据】
- 机房环境历史数据明细表：room_env_his_data           【需要结合机房和测点编码来查看】
- 机柜分析历史数据表：cabinet_his_data_analysis        【需要结合机房和测点编码来查看】

## 测试方法

- 逻辑部分按需求来，主要是构造不同日期的不同测点的数据
- 构造fsu索引，每15分钟一个数据点，校验历史数据设备测点，时间间隔计算统计的取值是否一致
- 温湿度有指定测点编码【017301，017302】
- 涉及到：【机柜--用电关系配置--需要对应电压电流功率等】【机柜--温湿度配置--需要对应湿度温度等】

## 测试数据准备

- 通过py造数脚本和开发往ES中插入fsu采集的数据【设备测点对应的电量电压功率、温湿度】，目前是每15分钟一组fsu采集数据
- 触发任务从fsu索引取设备【电量电压功率、温湿度】进行点位计算，例如：12点到12：30，每隔5分钟都会去一个数据点，这个点取该点前后15分钟距离该点最近那个数值

- 温湿度历史报表:落库表room_env_his_data：room_env_his_data
  - curl --location 'http://127.0.0.1:9102/v1/energyCabinet/statiscCabinetHisData' \--header 'Content-Type: application/json' \--data '{"startTime":"2025-07-26 12:00:00","endTime":"2025-07-26 14:00:00"}'
- 单机柜历史分析:落库表cabinet_his_data_analysis
  - curl --location 'http://127.0.0.1:9102/v1/energyCabinet/statiscRoomEnvHisData' \--header 'Content-Type: application/json' \--data '{"startTime":"2025-07-26 12:00:00","endTime":"2025-07-26 14:00:00"}'



# 机柜管理【B接口】

- 【机柜管理-机柜配置】

## 业务逻辑【需求概述】

- 

## 涉及库表

- 公共表：
  - 测点编码表：t_cfg_metemodel_detail
  - 测点编码模板：t_cfg_metemodel
  - 字典查询：t_cfg_dict

## 测试方法

- 

## 测试数据准备

- 

