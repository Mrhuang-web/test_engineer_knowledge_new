# BASS-260R门禁监控系统通讯协议解析（V2.1版）
## 一、通信基础规范
### 1.1 核心通信参数
| 参数 | 配置详情 |
|------|----------|
| 通信速率 | 9600bps |
| 数据格式 | 1位起始位、8位数据位、1位停止位、无校验 |
| 通信模式 | 主从模式（上位机SU为主，260R设备为从） |
| 超时时间 | 500毫秒（未收到响应则判定通信失败） |
| 协议版本 | V2.0（VER=20H）、V2.1（兼容V2.0） |
| 设备地址 | 1-254（ADR字段），支持分组扩展（16组×254台设备） |
| CID1固定值 | 80H（设备分类码=8，分组码=0） |

### 1.2 数据帧结构
#### 基础格式
`SOI(1字节) + VER(1字节) + ADR(1字节) + CID1(1字节) + CID2/RTN(1字节) + L.TH(2字节) + INFO(N字节) + CHK-SUM(2字节) + EOI(1字节)`

#### 核心字段说明
| 字段 | 标识/规则 | 描述 |
|------|-----------|------|
| SOI | 7EH | 信息起始符，固定值 |
| VER | 20H（V2.0）/ 21H（V2.1） | 协议版本，设备需适配对应版本 |
| ADR | 1-254 | 设备RS485地址 |
| CID1 | 80H | 设备分类码（高4位=8）+ 分组码（低4位=0） |
| CID2/RTN | - | 下发命令时为CID2（设置命令=49H，读取命令=4AH），响应时为执行结果 |
| L.TH | 2字节 | 参数长度标识（含校验位，计算规则见下文） |
| INFO | - | 命令参数（下发）或响应数据（上行），格式为`COMMAND GROUP + COMMAND TYPE + DATAF` |
| CHK-SUM | 2字节 | 校验和（VER至INFO末尾ASCII码累加，模65536取补） |
| EOI | 0DH | 信息结束符，固定值 |

#### L.TH计算规则
1. 数据信息字节长度为L，ASCII码个数LENID=2L
2. LENID按4位分组累加，模16取补得到LCHKSUM（高4位）
3. 16位结构：LCHKSUM（4位）+ LENID（12位）
4. 校验：4个4位分组累加和为0

#### 数据传输规则
- SOI、EOI按单字节直接发送
- 其余字段（VER至CHK-SUM）按4位拆分，先高4位ASCII码，后低4位ASCII码发送

### 1.3 设备应答码（RTN）
| RTN值 | 含义 |
|-------|------|
| 00H | 命令正常执行 |
| 04H | 对应存储空间为空 |
| 06H | 命令帧数据无效 |
| E3H | 参数修改/删除失败 |
| E4H | 存储空间已满 |
| EFH | 其他错误 |
| 01H | 协议版本不符 |

---

## 二、设置命令（CID2=49H）
### 2.1 设置日期时间（COMMAND TYPE=0XE0）
#### 命令参数（DATAF=8字节BCD）
| 字段 | 字节数 | 范围 | 说明 |
|------|--------|------|------|
| 年 | 2 | 2000-2099 | 世纪+年（如2012=20H+12H） |
| 月 | 1 | 1-12 | BCD格式 |
| 日 | 1 | 1-31 | BCD格式 |
| 星期 | 1 | 1-7 | 7代表星期日 |
| 时 | 1 | 0-23 | BCD格式 |
| 分 | 1 | 0-59 | BCD格式 |
| 秒 | 1 | 0-59 | BCD格式 |

#### 协议版本差异
| 协议版本 | COMMAND GROUP | 格式示例 |
|----------|---------------|----------|
| V2.0 | 0XF1 | 7E 20 01 80 49 [L.TH] F1 E0 [日期时间8字节] [CHK-SUM] 0D |
| V2.1 | 0XF3 | 7E 21 01 80 49 [L.TH] F3 E0 [日期时间8字节] [CHK-SUM] 0D |

#### 响应
- 成功：RTN=00H
- 失败：RTN=EFH

### 2.2 设置准进时段（COMMAND TYPE=0XF1）
#### 命令参数（DATAF=26字节）
| 字段 | 字节数 | 说明 |
|------|--------|------|
| 表号+星期 | 2 | 第1字节（0-15=表1-16），第2字节（1-7=星期1-日） |
| 时段1-6 | 24 | 每时段4字节（HHMM起始+HHMM结束，BCD格式） |

#### 协议版本差异
| 协议版本 | COMMAND GROUP | 限制条件 |
|----------|---------------|----------|
| V2.0 | 0XF1 | 仅支持表0-4（前5张表），表5-15设置返回EFH |
| V2.1 | 0XF3 | 需从表1星期1开始设置，修改表1星期1时擦除FLASH ROM |

#### 响应
- 成功：RTN=00H
- 失败：RTN=EFH

### 2.3 用户管理命令
#### 2.3.1 增加一个用户（COMMAND TYPE=0XE3）
| 协议版本 | COMMAND GROUP | 参数结构（DATAF） |
|----------|---------------|------------------|
| V2.0 | 0XF1 | 卡片编号（5字节）+ 用户ID（4字节）+ 密码（2字节）+ 有效期（4字节）+ 权限（1字节） |
| V2.1 | 0XF3 | 卡号长度（1字节）+ 卡片编号（10字节）+ 用户ID（4字节）+ 密码（2字节）+ 有效期（4字节）+ 权限（1字节） |

#### 关键参数说明
- 卡号：V2.1版本4字节卡号需前6字节补0，10字节为完整卡号
- 密码：固定为12H、34H（BCD码1234）
- 有效期：世纪+年+月+日（BCD格式，如20121231=20H+12H+12H+31H）
- 权限字节（D7-D0）：
  - D7-D6=11：特权用户（不受时段限制）
  - D7-D6=10：受工作日/休息日时段限制（D1-D0指定表号）
  - D7-D6=00/01：受星期时段限制（D3-D0指定表号）

#### 响应
- 成功：RTN=00H
- 失败：RTN=E3H（修改失败）/ E4H（空间已满）

#### 注意事项
1. 设备已存在该卡号时，直接更新信息，不返回错误
2. 用户ID返回4字节00H
3. 权限字节中D7-D6的设置不影响实际生效，均按星期准进时段处理

#### 2.3.2 删除用户卡（COMMAND TYPE=0XE4）
| 协议版本 | COMMAND GROUP | 参数结构（DATAF） |
|----------|---------------|------------------|
| V2.0 | 0XF1 | 指引（1字节=0）+ 卡片编号（5字节） |
| V2.1 | 0XF3 | 指引（1字节=0）+ 卡号长度（1字节=4/10）+ 卡片编号（10字节） |

#### 参数说明
- 卡号长度=4时：卡片编号前6字节补0，后4字节为真实卡号
- 卡号长度=10时：直接填写完整10字节卡号

#### 响应
- 成功：RTN=00H
- 失败：RTN=06H（数据无效）/ E3H（删除失败）

#### 2.3.3 删除用户编号（ID）（COMMAND TYPE=0XE4）
| 协议版本 | COMMAND GROUP | 参数结构（DATAF） |
|----------|---------------|------------------|
| V2.0 | 0XF1 | 指引（1字节=1）+ 00H + 用户ID（4字节） |
| V2.1 | 0XF3 | 指引（1字节=1）+ 00H + 用户ID（4字节） |

#### 注意事项
- 该命令现不支持用户编号功能，执行后可能返回失败

#### 响应
- 成功：RTN=00H
- 失败：RTN=06H（数据无效）/ E3H（删除失败）

#### 2.3.4 全部删除用户（COMMAND TYPE=0XE4）
| 协议版本 | COMMAND GROUP | 参数结构（DATAF） |
|----------|---------------|------------------|
| V2.0 | 0XF1 | 指引（1字节=2）+ 5字节全00H |
| V2.1 | 0XF3 | 指引（1字节=2）+ 5字节全00H |

#### 响应
- 成功：RTN=00H
- 失败：RTN=06H（数据无效）/ E3H（删除失败）

### 2.4 门特性参数设置
#### 2.4.1 门锁继电器执行时间（COMMAND TYPE=0XE6）
| 协议版本 | COMMAND GROUP | 参数（DATAF） | 说明 |
|----------|---------------|---------------|------|
| V2.0 | 0XF1 | 1字节（1-255） | 单位0.1秒，示例：50=5秒 |
| V2.1 | 0XF3 | 1字节（1-255） | 同V2.0 |

#### 响应
- 成功：RTN=00H

#### 2.4.2 开门延时时间（COMMAND TYPE=0XE7）
| 协议版本 | COMMAND GROUP | 参数（DATAF） | 说明 |
|----------|---------------|---------------|------|
| V2.0 | 0XF1 | 1字节（20-255） | 单位0.1秒，示例：50=5秒 |
| V2.1 | 0XF3 | 1字节（20-255） | 同V2.0 |

#### 响应
- 成功：RTN=00H

### 2.5 记录区管理
#### 2.5.1 清空记录（COMMAND TYPE=0XF0）
| 协议版本 | COMMAND GROUP | 参数（DATAF） | 说明 |
|----------|---------------|---------------|------|
| V2.0 | 0XF1 | 5字节全00H | 初始化记录区，清除所有历史记录 |
| V2.1 | 0XF3 | 5字节全00H | 同V2.0 |

#### 响应
- 成功：RTN=00H

#### 2.5.2 设定读指针（COMMAND TYPE=0XF0）
| 协议版本 | COMMAND GROUP | 参数（DATAF=3字节） | 说明 |
|----------|---------------|---------------------|------|
| V2.0 | 0XF1 | LOADP低位 + LOADP高位 + MF字节 | MF字节D7=1（记录区已写入），D0=1（已覆盖） |
| V2.1 | 0XF3 | 同V2.0 | 同V2.0 |

#### 响应
- 成功：RTN=00H

#### 2.5.3 设定整个记录区指针（COMMAND TYPE=0XF0）
| 协议版本 | COMMAND GROUP | 参数（DATAF=5字节） | 说明 |
|----------|---------------|---------------------|------|
| V2.0 | 0XF1 | SAVEP（2字节）+ LOADP（2字节）+ MF字节 | SAVEP=下一条记录存储位置，LOADP=下一次读取位置 |
| V2.1 | 0XF3 | 同V2.0 | 同V2.0 |

#### 响应
- 成功：RTN=00H

### 2.6 远程开关门（COMMAND TYPE=0XED）
#### 2.6.1 不带操作员信息
| 协议版本 | COMMAND GROUP | 参数（DATAF） | 说明 |
|----------|---------------|---------------|------|
| V2.0 | 0XF1 | 1字节（1=开门，0=不操作） | 控制所有门或指定门（按设备配置） |
| V2.1 | 0XF3 | 1字节（1=开门，0=不操作） | 同V2.0 |

#### 响应
- 成功：RTN=00H

#### 2.6.2 带操作员信息
| 协议版本 | COMMAND GROUP | 参数（DATAF=6字节） | 说明 |
|----------|---------------|---------------------|------|
| V2.0 | 0XF1 | 1字节（1=开门）+ 操作员编号（5字节） | 操作员编号首字节补0，使用后4字节 |
| V2.1 | 0XF3 | 同V2.0 | 同V2.0 |

#### 响应
- 成功：RTN=00H

### 2.7 设置参数（CID2=0X80）
#### 命令参数（COMINFO）
| 字段 | 长度 | 描述 |
|------|------|------|
| 起始符 | 1字节 | 0XFF |
| 命令 | 1字节 | 0X61 |
| 长度 | 1字节 | 0X1D |
| 命令序号 | 1字节 | 0X61 |
| 数据 | 28字节 | 区号（6BIT）+ 站号（10BIT）+ 注册码（1BYTE）+ 用户码（2BYTE）+ 继电器时间（3BYTE）+ 屏蔽时间（2BYTE）+ 恢复提示时间（1BYTE）+ 黑白名单工作方式（4BIT）+ 门数目（4BIT）+ 黑白名单数目（2BYTE）+ 时间（8BYTE）+ 清除告警（1BYTE）+ 主动上传（1BYTE）+ 工作模式（1BYTE）+ 485读卡头数目（1BYTE）+ 红外参数（1BYTE）+ 预留（1BYTE） |
| 校验 | 1字节 | 异或校验 |
| 结束符 | 1字节 | 0XFE |

#### 响应
- 成功：RTN=00H，应答数据无有效内容

### 2.8 增加白、黑名单（CID2=0X80）
#### 命令参数（COMINFO）
| 字段 | 长度 | 描述 |
|------|------|------|
| 起始符 | 1字节 | 0XFF |
| 命令 | 1字节 | 0X58 |
| 长度 | 1字节 | 0X03 + 数目×4 |
| 命令序号 | 1字节 | 0X58 |
| 数据 | 3+4×N字节 | 类型（1BYTE：0=白名单/1=黑名单）+ 总数目（1BYTE）+ 卡号列表（每条4BYTE） |
| 校验 | 1字节 | 异或校验 |
| 结束符 | 1字节 | 0XFE |

#### 响应
- 成功：命令=0X00，长度=0X01，应答序号=0X58

### 2.9 减少白、黑名单（CID2=0X80）
#### 命令参数（COMINFO）
| 字段 | 长度 | 描述 |
|------|------|------|
| 起始符 | 1字节 | 0XFF |
| 命令 | 1字节 | 0X59 |
| 长度 | 1字节 | 0X03 + 数目×4 |
| 命令序号 | 1字节 | 0X59 |
| 数据 | 3+4×N字节 | 类型（1BYTE：0=白名单/1=黑名单）+ 总数目（1BYTE）+ 卡号列表（每条4BYTE） |
| 校验 | 1字节 | 异或校验 |
| 结束符 | 1字节 | 0XFE |

#### 响应
- 成功：命令=0X00，长度=0X01，应答序号=0X59

---

## 三、读取信息命令（CID2=4AH）
### 3.1 读取实时钟（COMMAND TYPE=0XE0）
| 协议版本 | COMMAND GROUP | 参数（DATAF） | 说明 |
|----------|---------------|---------------|------|
| V2.0 | 0XF2 | 1字节=0 | 读取设备当前时间 |
| V2.1 | 0XF4 | 1字节=0 | 同V2.0 |

#### 响应数据（DATAINFO=8字节BCD）
| 字段 | 字节数 | 说明 |
|------|--------|------|
| 年 | 2 | 2000-2099（世纪+年） |
| 月 | 1 | 1-12 |
| 日 | 1 | 1-31 |
| 星期 | 1 | 1-7（7=星期日） |
| 时 | 1 | 0-23 |
| 分 | 1 | 0-59 |
| 秒 | 1 | 0-59 |

### 3.2 读取记录信息
#### 3.2.1 读取历史记录柜桶参数（COMMAND TYPE=0XE1）
| 协议版本 | COMMAND GROUP | 参数（DATAF） | 说明 |
|----------|---------------|---------------|------|
| V2.0 | 0XF2 | 1字节=0 | 读取记录区存储状态 |
| V2.1 | 0XF4 | 1字节=0 | 同V2.0 |

#### 响应数据（DATAINFO=9字节）
| 字段 | 字节数 | 说明 |
|------|--------|------|
| BOTTOM | 2 | 记录区起始地址（默认0） |
| SAVEP | 2 | 下一条记录存储地址 |
| LOADP | 2 | 下一条读取地址 |
| MF | 1 | 修改标志（D7=1=已写入，D0=1=已覆盖） |
| MAXLEN | 2 | 最大记录数（固定16384） |

#### 有效记录数计算规则
1. SAVEP > LOADP：未读取记录数=SAVEP-LOADP
2. SAVEP < LOADP：未读取记录数=MAXLEN-LOADP+SAVEP

#### 3.2.2 顺序读取一条历史记录（COMMAND TYPE=0XE2）
| 协议版本 | COMMAND GROUP | 参数（DATAF） | 说明 |
|----------|---------------|---------------|------|
| V2.0 | 0XF2 | 1字节=0 | 从LOADP位置读取，读完后LOADP自动+1 |
| V2.1 | 0XF4 | 1字节=0 | 同V2.0，卡号返回格式优化 |

#### 响应数据（DATAINFO）
| 协议版本 | 字段 | 字节数 | 说明 |
|----------|------|--------|------|
| V2.0 | 事件来源 | 5 | 卡号或ID号 |
| | 日期时间 | 7 | 年（2）+月（1）+日（1）+时（1）+分（1）+秒（1） |
| | 状态 | 1 | STATUS（D7-D0） |
| | 备注 | 1 | REMARK（D7=1=已读取） |
| V2.1 | 事件来源 | 11 | 卡号长度（1）+卡号（10），4字节卡号前6字节补0 |
| | 日期时间 | 7 | 同V2.0 |
| | 状态 | 1 | 同V2.0 |
| | 备注 | 1 | 同V2.0 |

#### 响应说明
- 无记录时：RTN=04H

#### 3.2.3 随机读取记录（COMMAND TYPE=0XE2）
| 协议版本 | COMMAND GROUP | 参数（DATAF） | 说明 |
|----------|---------------|---------------|------|
| V2.0 | 0XF2 | 2字节（低位在前） | 指定LOADP位置读取，不修改原LOADP |
| V2.1 | 0XF4 | 2字节（低位在前） | 同V2.0 |

#### 响应数据
- 同顺序读取一条历史记录格式
- 无效位置时：RTN=04H

#### 3.2.4 附带顺序号读取记录（COMMAND TYPE=0XEE）
| 协议版本 | COMMAND GROUP | 参数（DATAF） | 说明 |
|----------|---------------|---------------|------|
| V2.0 | 0XF2 | 1字节=1 | 读取LOADP位置记录及LOADP值，防止记录丢失 |
| V2.1 | 0XF4 | 1字节=1 | 同V2.0 |

#### 响应数据
| 协议版本 | 字段 | 字节数 | 说明 |
|----------|------|--------|------|
| V2.0 | LOADP值 | 2 | 读取记录的位置序号 |
| | 事件来源 | 5 | 卡号或ID号 |
| | 日期时间 | 7 | 同前 |
| | 状态 | 1 | 同前 |
| | 备注 | 1 | 同前 |
| V2.1 | LOADP值 | 2 | 同V2.0 |
| | 事件来源 | 11 | 同前 |
| | 日期时间 | 7 | 同前 |
| | 状态 | 1 | 同前 |
| | 备注 | 1 | 同前 |

#### 3.2.5 查询最新事件记录（COMMAND TYPE=0XEE）
| 协议版本 | COMMAND GROUP | 参数（DATAF） | 说明 |
|----------|---------------|---------------|------|
| V2.0 | 0XF2 | 1字节=0 | 读取最新一条事件记录（刷卡、告警、手动开门等） |
| V2.1 | 0XF4 | 1字节=0 | 同V2.0 |

#### 响应数据
- 同顺序读取一条历史记录格式

### 3.3 读取准进时段（COMMAND TYPE=0XEB）
| 协议版本 | COMMAND GROUP | 参数（DATAF=2字节） | 说明 |
|----------|---------------|---------------------|------|
| V2.0 | 0XF2 | 表号（0-15）+ 星期（1-7） | 读取指定表指定星期的6个时段 |
| V2.1 | 0XF4 | 同V2.0 | 同V2.0 |

#### 响应数据（DATAINFO=24字节BCD）
| 时段 | 字节数 | 格式 |
|------|--------|------|
| 时段1-6 | 4×6=24 | 每时段=HHMM起始+HHMM结束 |

#### 注意事项
- 表5-15返回24字节全00H

### 3.4 读取用户信息
#### 3.4.1 读取用户数目（COMMAND TYPE=0XE5）
| 协议版本 | COMMAND GROUP | 参数（DATAF） | 说明 |
|----------|---------------|---------------|------|
| V2.0 | 0XF2 | 1字节=0 | 读取已存储用户总数 |
| V2.1 | 0XF4 | 1字节=0 | 同V2.0 |

#### 响应数据（DATAINFO=2字节HEX）
- 低字节在前，高字节在后，表示用户数量

#### 3.4.2 读取指定位置用户（COMMAND TYPE=0XE6）
| 协议版本 | COMMAND GROUP | 参数（DATAF） | 说明 |
|----------|---------------|---------------|------|
| V2.0 | 0XF2 | 2字节（低位在前） | 指定存储位置读取用户资料 |
| V2.1 | 0XF4 | 2字节（低位在前） | 同V2.0 |

#### 响应数据（DATAINFO）
| 协议版本 | 字段 | 字节数 | 说明 |
|----------|------|--------|------|
| V2.0 | 卡片编号 | 5 | HEX格式 |
| | 用户ID | 4 | BCD格式，返回全00H |
| | 密码 | 2 | BCD格式，返回全00H |
| | 有效期 | 4 | BCD格式（世纪+年+月+日） |
| | 用户权限 | 1 | 同增加用户权限格式 |
| V2.1 | 卡号长度 | 1 | HEX格式 |
| | 卡片编号 | 10 | HEX格式 |
| | 用户ID | 4 | BCD格式，返回全00H |
| | 密码 | 2 | BCD格式，返回全00H |
| | 有效期 | 4 | BCD格式 |
| | 用户权限 | 1 | 同增加用户权限格式 |

#### 响应说明
- 无权限时：RTN=0XE0，无DATAINFO

#### 3.4.3 查询指定用户ID是否存在（COMMAND TYPE=0XE6）
| 协议版本 | COMMAND GROUP | 参数（DATAF） | 说明 |
|----------|---------------|---------------|------|
| V2.0 | 0XF2 | 4字节用户ID（BCD） | 验证该ID是否已注册 |
| V2.1 | 0XF4 | 4字节用户ID（BCD） | 同V2.0 |

#### 响应
- 存在：RTN=00H
- 不存在：RTN=06H

### 3.5 远程监控（COMMAND TYPE=0XE7）
| 协议版本 | COMMAND GROUP | 参数（DATAF） | 说明 |
|----------|---------------|---------------|------|
| V2.0 | 0XF2 | 1字节=0 | 读取设备工作状态和线路状态 |
| V2.1 | 0XF4 | 1字节=0 | 同V2.0 |

#### 响应数据（DATAINFO=2字节）
| 字节 | 字段 | 位定义（D7-D0） |
|------|------|----------------|
| 1 | 设备工作状态 | D7=实时钟状态（0=正常），D6=存储器状态（0=正常），D5=电源状态（0=正常），D2=门监控使能（1=启用），D1=继电器状态（1=加电），D0=报警状态（1=告警） |
| 2 | 线路状态 | D7=紧急输入，D3=门状态（1=开），D1=手动按键（1=按下），D0=继电器状态（1=加电） |

### 3.6 读取工作特性参数
#### 3.6.1 读取控制信息（COMMAND TYPE=0XE8）
| 协议版本 | COMMAND GROUP | 参数（DATAF） | 说明 |
|----------|---------------|---------------|------|
| V2.0 | 0XF2 | 1字节=0 | 读取门控、红外等控制参数 |
| V2.1 | 0XF4 | 1字节=0 | 同V2.0 |

#### 响应数据（DATAINFO=5字节）
| 字节 | 字段 | 说明 |
|------|------|------|
| 1 | 控制字 | D7=门监控（1=启用），D5=机械锁标识（1=需机械动作），D4=手动开门允许（0=允许），D3=门磁电平（0=开门短路） |
| 2 | 继电器执行时间 | 单位0.1秒 |
| 3 | 开门延时时间 | 单位0.1秒 |
| 4 | 预留 | 无定义，填0 |
| 5 | 卡号获取控制字 | 感应卡号码读取方式 |

### 3.7 读取设备名称及版本号（COMMAND TYPE=0XEF）
| 协议版本 | COMMAND GROUP | 参数（DATAF） | 说明 |
|----------|---------------|---------------|------|
| V2.0 | 0XF2 | 1字节=0 | 读取设备型号和软件版本 |
| V2.1 | 0XF4 | 1字节=0 | 同V2.0 |

#### 响应数据（DATAINFO=18字节ASCII）
- 格式：设备名称+“,”+版本号（不足18字节后补0）
- 示例：“260R设备,VER5.01”

### 3.8 读取所有通道值（COMMAND TYPE=0X7F）
| 协议版本 | COMMAND GROUP | 参数（DATAF） | 说明 |
|----------|---------------|---------------|------|
| V2.0 | 0XF2 | 无 | 读取16个通道及输出状态 |
| V2.1 | 0XF4 | 无 | 同V2.0 |

#### 响应数据（DATAINFO=54字节）
| 字段 | 字节数 | 说明 |
|------|--------|------|
| 通道值 | 3×16=48 | 每通道=告警信息（1）+通道值（2），数字通道高电平=FF FF，低电平=00 00 |
| 光耦/继电器状态 | 3 | 光耦（2字节）+继电器（1字节） |
| 告警输出 | 1 | 8位告警标识（电压/门禁/盗情等） |
| 预留 | 2 | 全0 |

### 3.9 读取下挂传感器通道值（COMMAND TYPE=0X9F）
| 协议版本 | COMMAND GROUP | 参数（DATAF） | 说明 |
|----------|---------------|---------------|------|
| V2.0 | 0XF2 | 1字节=0（读所有）/ N（读指定N个） | 读取32个扩展通道值 |
| V2.1 | 0XF4 | 同V2.0 | 同V2.0 |

#### 响应数据（DATAINFO=3×N字节）
| 字段 | 字节数 | 说明 |
|------|--------|------|
| 单通道值 | 3 | 告警信息（1）+通道值（2），传感器异常=00 F0 F0 |

### 3.10 参数读取（CID2=0X80）
#### 命令参数（COMINFO）
| 字段 | 长度 | 描述 |
|------|------|------|
| 起始符 | 1字节 | 0XFF |
| 命令 | 1字节 | 0X60 |
| 长度 | 1字节 | 0X01 |
| 命令序号 | 1字节 | 0X60 |
| 校验 | 1字节 | 异或校验 |
| 结束符 | 1字节 | 0XFE |

#### 响应数据（DATAINFO=29字节）
- 格式同2.7节设置参数的数据字段，时间按BCD码返回

### 3.11 数据包内嵌协议（CID2=0X81）
#### 命令格式
- 通用协议数据包作为内嵌数据，示例：
  - 发送：7E 20 01 80 81 [L.TH] [通用协议数据包] [CHK-SUM] 0D
  - 响应：7E 20 01 80 00 [L.TH] [通用协议应答包] [CHK-SUM] 0D

#### 支持的通用协议命令号
- 0x02（设备初始化）、0x03（设置地址）、0x04（读取地址）、0x05（读取版本号）等（完整列表见附录2）

### 3.12 通信参数说明
1. 日期时间均为BCD格式，例：0X10=10月/10时
2. 数值参数均为低字节在前、高字节在后（HEX/BCD）
3. CID1高4位固定为8（设备分类），低4位为分组号（0-15）

---

## 四、附录
### 附录1：历史记录格式（REMARK字段）
| REMARK值 | 记录类型 | 事件来源 | 状态（STATUS）说明 |
|----------|----------|----------|-------------------|
| 0 | 刷卡开门 | 5字节卡号 | D6=门原状态（0=关），D4=关门状态（0=正常），D2=进门标志（0=进门） |
| 2 | 远程开门 | 5字节全0/操作员编号 | 同刷卡开门 |
| 3 | 手动开门 | 5字节全0 | 同刷卡开门 |
| 22H | 紧急联动开始 | 5字节全0 | STATUS=0 |
| 22H | 紧急联动结束 | 4字节全0+1 | STATUS=0 |
| 5 | 报警/取消 | 4字节全0+报警源 | D3=门状态（0=关），D1=按键状态（0=松开） |
| 6 | 设备掉电 | 重新上电时间 | 同报警记录状态 |
| 7 | 参数修改 | 4字节全0+修改标记 | 修改标记位对应修改项（D0=密码，D1=门参数等） |
| 8 | 无效卡刷卡 | 5字节卡号 | 同报警记录状态 |
| 9 | 卡过期 | 5字节卡号 | 同报警记录状态 |
| 10 | 无进权限 | 5字节卡号 | 同报警记录状态 |
| 11 | 非法开门 | 5字节全0 | STATUS=00H |
| 12 | 非法离开 | 5字节卡号 | STATUS=00H |
| 13 | 离开未关门 | 5字节卡号 | STATUS=00H |
| 14 | 巡检卡 | 5字节卡号 | STATUS=00H |

### 附录2：支持的通用协议命令号（部分）
| 命令号 | 功能描述 | 命令号 | 功能描述 |
|--------|----------|--------|----------|
| 0x02 | 设备初始化 | 0x36 | 增加黑白名单 |
| 0x03 | 设置地址 | 0x37 | 减少黑白名单 |
| 0x04 | 读取地址 | 0x38 | 清空黑白名单 |
| 0x05 | 读取版本号 | 0x39 | 读取黑白名单 |
| 0x06 | 设置系统时间 | 0x3A | 开锁 |
| 0x07 | 读取系统时间 | 0x3B | 设置时段信息 |
| 0x10 | 读取通道值 | 0x3C | 读取时段信息 |
| 0x13 | 设置密码 | 0x63 | 增加临时卡 |
| 0x16 | 读取历史告警 | 0x80 | 短信开门第一步 |
| 0x17 | 远程控制继电器 | 0x81 | 短信开门第二步 |
