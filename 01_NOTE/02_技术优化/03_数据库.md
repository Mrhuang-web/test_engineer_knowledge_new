# 01_mysql语法

## 存储过程

```

```

## 查询优化

```
union

SQL 的 WHERE 条件存在逻辑优先级问题，导致全表扫描 + 多次子查询嵌套，数据量一大就“假死”

明确括号优先级 + 使用 EXISTS 替代 IN


避免在 WHERE 子句中用 IN + 子查询，大数据量下性能极差；
用 EXISTS 或 JOIN 替代 IN；
确保相关字段有索引：
    overdue_device_detail(sys_device_id, room_id, device_type_name)
    t_cfg_device(power_device_id, precinct_id, device_type)
    t_cfg_dict(dict_code, col_name)
```



# 02_oceanbase语法

注意公司目前用的oceanbase，并且是mysql模式

## 存储过程

```
注意：好像是没有这个功能

sql确认是否创建成功【mysql类】
	-- 查看当前数据库下的所有存储过程
	SHOW PROCEDURE STATUS WHERE Db = DATABASE();

    -- 或者查询 information_schema 系统库
    SELECT ROUTINE_NAME, ROUTINE_TYPE, CREATED 
    FROM information_schema.ROUTINES 
    WHERE ROUTINE_SCHEMA = DATABASE() AND ROUTINE_TYPE = 'PROCEDURE';


```

## 表结构查询

```
说明：
	information_schema： 这是一个每个 MySQL/MariaDB 都自带的数据库，它存储了关于所有其他数据库（如你的业务数据库 my_app_db）、表、列、权限等所有元数据信息。
	columns： 这是 information_schema 数据库里的一个视图（可以当表来查询），它包含了所有列的信息。
	

操作1:查看某个数据库的所有表结构（最常用）
	SELECT 
    TABLE_NAME AS '表名',
    COLUMN_NAME AS '列名',
    COLUMN_TYPE AS '数据类型',
    IS_NULLABLE AS '允许空',
    COLUMN_DEFAULT AS '默认值',
    EXTRA AS '额外信息',
    COLUMN_COMMENT AS '列注释'
FROM 
    information_schema.columns 
WHERE 
    TABLE_SCHEMA = 'my_company' -- 替换为你的数据库名
ORDER BY 
    TABLE_NAME, 
    ORDINAL_POSITION;
    
    


操作2：查看特定表的结构（例如 users 表）
	SELECT 
    COLUMN_NAME AS '列名',
    COLUMN_TYPE AS '数据类型',
    IS_NULLABLE AS '允许空',
    COLUMN_DEFAULT AS '默认值',
    COLUMN_KEY AS '索引',
    EXTRA AS '额外信息',
    COLUMN_COMMENT AS '列注释'
FROM 
    information_schema.columns 
WHERE 
    TABLE_SCHEMA = '数据库名' 
    AND TABLE_NAME = 'users' -- 指定表名
ORDER BY 
    ORDINAL_POSITION;
```



# 03_MYSQL与Oceanbase区别

```
https://zhuanlan.zhihu.com/p/434788856
oceanbase：分布式关系型数据库

1. 分布式存储
OceanBase将数据分散存储在多个节点上，每个节点负责存储一部分数据。通过分布式存储，OceanBase可以实现数据的水平扩展，即通过增加节点来提高系统的处理能力和存储容量。

2. 分布式计算
OceanBase采用分布式计算架构，将查询请求分发到各个节点上并行处理。这样可以显著提高查询效率，降低延迟。

3. 数据一致性
OceanBase通过多版本并发控制（MVCC）和数据复制机制来保证数据的一致性。多版本并发控制允许多个事务同时读取和修改数据，而不会相互影响。数据复制机制则通过在多个节点上复制数据，确保数据在发生故障时仍然可用。


1. 兼容性
OceanBase在设计时考虑了与MySQL的兼容性，使得用户可以在不改变现有业务逻辑的情况下，平滑迁移到OceanBase。OceanBase支持标准的MySQL协议，包括SQL语法、存储引擎等。

2. 存储引擎
OceanBase使用自己的存储引擎，与MySQL的InnoDB存储引擎有所不同。InnoDB存储引擎主要针对单机环境进行优化，而OceanBase的存储引擎则针对分布式环境进行优化。

3. 核心架构
OceanBase的核心架构与MySQL有较大差异。MySQL采用单机数据库架构，而OceanBase采用分布式数据库架构。这使得OceanBase在性能、可用性和可扩展性方面具有明显优势
```

# 04_heidisql工具

## 数据库类型检测

```
SQL 查询：
	SELECT VERSION();

	SELECT @@version;
	
查看连接属性
	DBeaver 中，右键点击您的数据库连接
	选择 "编辑连接"
	查看连接设置中的数据库类型/驱动信息：
		MySQL 连接通常会使用 "MySQL" 驱动
		OceanBase 连接可能会使用 "OceanBase" 驱动或修改过的 MySQL 驱动
		
查看 DBeaver 连接列表
	DBeaver 的连接列表中，通常会显示数据库类型图标：
		MySQL 连接会显示 MySQL 的大象图标
		OceanBase 连接可能会显示不同的图标或标注
```



## 快速检索字段所在表

- 方式1：界面方式

  - 在左侧数据库导航栏中，**右键点击目标数据库**（或服务器根节点以搜索所有数据库）→ 选择 **`查找`** → **`查找文本`**。
  - 快捷键：`Ctrl + Shift + F`。

- 方式2：sql方式更快

  - ```
    SELECT 
        c.TABLE_SCHEMA AS '数据库',
        c.TABLE_NAME AS '表名',
        t.TABLE_COMMENT AS '表注释',
        c.COLUMN_NAME AS '字段名',
        c.COLUMN_COMMENT AS '字段注释'  -- 可选添加
    FROM INFORMATION_SCHEMA.COLUMNS c
    JOIN INFORMATION_SCHEMA.TABLES t
        ON c.TABLE_SCHEMA = t.TABLE_SCHEMA
        AND c.TABLE_NAME = t.TABLE_NAME
    WHERE c.COLUMN_NAME LIKE '%phone%'
      AND c.TABLE_SCHEMA = 'customer_db';
    ```

# 05_dbeaver工具

## 数据库类型检测

```
SQL 查询：
	SELECT VERSION();

	SELECT @@version;
	
查看连接属性
	DBeaver 中，右键点击您的数据库连接
	选择 "编辑连接"
	查看连接设置中的数据库类型/驱动信息：
		MySQL 连接通常会使用 "MySQL" 驱动
		OceanBase 连接可能会使用 "OceanBase" 驱动或修改过的 MySQL 驱动
		
查看 DBeaver 连接列表
	DBeaver 的连接列表中，通常会显示数据库类型图标：
		MySQL 连接会显示 MySQL 的大象图标
		OceanBase 连接可能会显示不同的图标或标注
```



## 快速执行

```
ctrl+enter
```

## 查询结果范围调节

```
默认每次获取200条,在滚动到本页底部时自动加载下一页

可以在窗口--->首选项-->编辑器--->数据编辑器 中修改

要获取全部,在数据中右键--->导航--->获取所有数据
```

## 脚本导入和导出

```
文件-->导入---DBweaver---脚本
这样会复制一份到默认保存目录:C:\Users\你的windows用户名\AppData\Roaming\DBeaverData\workspace6\工程名\Scripts,

这样导入进来的打开时会在默认的数据库下,而直接拖入或者Scripts  
右键---创建---链接文件夹,打开的sql则 所属 数据库连接 和 数据库 都是 N/A 需要手动进行选择

设置默认方法:在数据库上右键---设置默认值
```

## 导出数据

```
7.1 
选中数据库表--右键--导出数据
这种方法可导出多种类型,如txt,csv,json及sql等,但sql 只能导出insert sql语句,不能添加drop和create语句

7.2  (推荐)
选中表---右键---工具---转储数据库;
可以选择添加drop ,create及其他选项,注意 要想每条数据一个insert语句,则要去掉"扩展插入"前面复选框的勾选
 
7.3  (推荐)
选中表结果---可导出sql语句
```

## 数据库表关系查看

```
1、连接数据库后，双击需要查看表关系的数据库。
2、选择【图】视图即可查看表关联关系。

通过查询【information_schema】系统数据库的【key_column_usage表】，可以查询指定表的外键关联信息
```

## 数据表/字段定位【重点】

```
点击顶部【搜索-搜索】
在搜索界面，选择【数据库元数据】，输入要搜索的关键字，此处输入的是完整表名。
另外要在【对象类型】中，勾选【Table】表示搜索表
点击【搜索】，DBeaver就会显示搜索结果，显示出该表所属的数据库，双击表名即可快速打开表

该功能不仅支持快速定位到表，还支持检索字段。
只需要在搜索时，勾选【Table column】即可检索字段，该功能会搜索数据库连接（此处是本地）中，所有数据库中包含指定字段的表。


技巧类
点击菜单栏中的【窗口】选项，然后选择【首选项】，进入DBeaver软件的设置界面
从左侧列表中找到【用户界面】并展开，随后选择【键】
此时，在右侧窗口会显示各种命令及其对应的当前快捷键设置
可以根据需求修改快捷键 - 这样就可以快速搜索
```

## 输出结果字段带注释【重点】

```
进入 窗口-首选项 → 用户界面 → 数据编辑器 → 数据查看

勾选：
"在数据编辑器工具提示中显示描述"
"在列标题中显示描述图标"

点击 应用并关闭 → 无需重启，设置即时生效
```

