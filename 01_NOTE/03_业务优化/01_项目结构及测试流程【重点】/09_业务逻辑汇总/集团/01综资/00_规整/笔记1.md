# 01_公共点

```
1、综资数据特点，基本都是录入的静态数据数据，可以忽略增量
2、综资数据涉及到动环专业共31个表
	其中22个设备类型表；
	1个专业内输出分路表、1个跨专业输出分路表、
	1个站点属性表、1个机房属性表、
	5个空间位置表；
	3个映射表
	对应关系表（每个表都会根据batch_num来写入对应批次数据）：
		mpp：dim_zz_sync_data_info
		dh：zz_sync_data_info
3、所有省市区都需要参照综资枚举值判断
	涉及文件：1、网络资源通用标准数据模型-空间v2.1-20240815
	涉及sheet：区域信息（区县及以上）字典表（以实际行政划分为准）
4、综资与动环层级区分
	动环-数据中心 ： 综资-园区
	动环-楼栋、通信枢纽楼、传输节点、通信基站 ： 综资-站点
		属性表中站点类别	  空间表中对应站点类型（两者关联）
		核心机楼：			核心站点、核心站点（配套），包含数据中心楼栋
        传输节点：			骨干站点、汇聚站点
        通信基站：			接入站点、用户站点
5、涉及模块
	综资-视图-综资视图
	综资-报表-原始数据
	分析-统计查询
	综合-供电拓扑
```

# 02_综资数据同步

```
1、所有的综资数据都是通过用户推送过来的csv - 且根据最新批次导入es/mpp
	同步的数据依据：dh：zz_sync_data_info批次表决定

2、涉及
```



# 03_动环与综资匹配

```
涉及到动环与综资匹配的业务都采用这块的逻辑

当前问题：
	当前数据中心（园区）走的是mpp的

映射方式匹配（id法）
	1、动环数据中心 -> 综资数据中心（园区）映射
        目前直接采用dh数据库的zz_to_rm_rm_area_dc进行匹配（根据批次号进行匹配）
            动环precinct_id 与 映射表ods_zz_irms_dc_map -> dh_id
            再由映射表ods_zz_irms_dc_map -> zg_name 与 数据中心园区（空间）zz_to_rm_rm_area_dc -> int_id匹配
            最终完成园区的匹配
	2、站点映射匹配（有问题）
			（dh_name -> dh_id）
			动环precinct_id 与 映射表ods_zz_irms_site_map -> dh_id
            再由映射表ods_zz_irms_site_map -> zg_name 与 数据中心园区（空间）zz_to_rm_rm_area_site -> int_id匹配
            最终完成园区的匹配
	3、机房映射匹配（有问题）
			前置条件：机房所属动环站点已经匹配综资，综资内机房related_site绑定着已匹配站点
			（dh_name -> dh_id）
			动环precinct_id 与 映射表ods_zz_irms_rom_map -> dh_id
            再由映射表ods_zz_irms_rom_map -> zg_name 与 数据中心园区（空间）zz_to_rm_rm_area_room -> int_id匹配
            最终完成园区的匹配
		


名称法：
	前置条件：空间表/属性表（(动环)省 --> (综资)省 ；(动环)市 -->  (综资)市 ；(动环)区 -->  (综资)区 ） 均匹配
		参考：（综资）区域信息（区县及以上）字典表；（动环）precinct表中area_code
	1、数据中心（有问题）
		（动环）precinct_name -> (综资)zz_to_rm_rm_area_dc zh_label匹配
	2、站点
		（动环）precinct_name -> (综资)zz_to_rm_rm_area_site zh_label匹配
		(综资)zz_to_rm_rm_area_site related_dc -> (综资)zz_to_rm_rm_area_dc int_id 匹配 [且园区已匹配动环]
		（综资）zz_to_rm_rm_area_site int_id -> (综资)ods_zz_site_property zh_label匹配
	3、楼栋
		（动环）precinct_name -> (综资)zz_to_rm_rm_area_site zh_label匹配
		（综资）zz_to_rm_rm_area_site int_id -> (综资)ods_zz_site_property zh_label匹配
	4、机房
		前置：机房对应的站点已经完成综资匹配（即related_site -> 在站点层已经完成匹配）
		（动环机房）precinct_name -> (综资)zz_to_rm_rm_area_room zh_label匹配
		（综资）zz_to_rm_rm_area_room int_id -> (综资)ods_zz_room_property zh_label匹配
		(综资)ods_zz_room_property power_related_site_name -> (动环-站点)precinct_name
	5、设备
		关联的related_site（站点），已经匹配动环
		power_device_id 与所关联站点下设备device_id一致
```



# 04_原始数据

```
功能作用：全部都为综资最新批次数据（其他涉及综资功能的数据来源）

1、根据综资省市区编码 -> 将原始综资展示到原始数据对应报表页面
2、属性表可以根据zh_label（站点名称）、到空间表找到int_id(资源标识)
3、属性表中power_monitoring_site_name（动环监控站点名称）与动环站点匹配可弹窗展示

涉及服务/脚本：

```



# 05_综资视图

```
功能作用：全部都为综资空间与综资属性关联的数据
	站点层级：综资空间站点（int_id） -> 综资站点属性表（zh_label） --> 同时batch_num要一直，省市区编码也要一致 
	机房层级：综资空间机房（int_id） -> 综资机房属性表（zh_label） --> 同时batch_num要一直，省市区编码也要一致
	设备层级：综资设备（related_room,related_site,省市区编码） --> 都需要和站点（int_id）和机房(int_id)的一致


省市区：横排展示
数据中心/站点、楼栋、机房、设备类型、设备系统、设备：竖排展示
补充：动环站点 - 综资空间站点 - 综资属性表站点类型 -> 参考01_公共点中第4点
仅统计通信枢纽楼和数据中心的


涉及服务/脚本：
```





