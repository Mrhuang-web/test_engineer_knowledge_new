<mxfile host="Electron" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/28.0.6 Chrome/138.0.7204.100 Electron/37.2.3 Safari/537.36" version="28.0.6" pages="4">
  <diagram name="门禁业务走向" id="d9qjZ9Z80NZqSt5mY1vD">
    <mxGraphModel dx="1426" dy="849" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="QTVUR145h4MCUghPp-7F-3" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="QTVUR145h4MCUghPp-7F-1" target="QTVUR145h4MCUghPp-7F-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="QTVUR145h4MCUghPp-7F-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="QTVUR145h4MCUghPp-7F-1" target="QTVUR145h4MCUghPp-7F-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="QTVUR145h4MCUghPp-7F-1" value="&lt;b&gt;门禁管理-人员管理&lt;/b&gt;&lt;div&gt;新增人员（用于给用户授权门禁卡）&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="244" y="208.5" width="210" height="41" as="geometry" />
        </mxCell>
        <mxCell id="QTVUR145h4MCUghPp-7F-7" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="QTVUR145h4MCUghPp-7F-2" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="779" y="229" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="QTVUR145h4MCUghPp-7F-2" value="&lt;b&gt;绑定门禁卡&lt;/b&gt;&lt;div&gt;目前手动输入或选择已有门禁卡&lt;/div&gt;&lt;div&gt;可以同时绑定多张&lt;/div&gt;" style="whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="579" y="199" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="QTVUR145h4MCUghPp-7F-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="QTVUR145h4MCUghPp-7F-8" target="QTVUR145h4MCUghPp-7F-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="QTVUR145h4MCUghPp-7F-14" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="QTVUR145h4MCUghPp-7F-8" target="QTVUR145h4MCUghPp-7F-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="QTVUR145h4MCUghPp-7F-8" value="&lt;b&gt;门禁管理-门禁权限&lt;/b&gt;&lt;div&gt;对应部门列表下就会新增展示人员&lt;/div&gt;&lt;div&gt;下拉会显示门禁卡&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="787" y="201.5" width="198" height="55" as="geometry" />
        </mxCell>
        <mxCell id="QTVUR145h4MCUghPp-7F-9" value="部门来自&lt;div&gt;系统管理-本机构管理&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="579" y="16" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="QTVUR145h4MCUghPp-7F-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="QTVUR145h4MCUghPp-7F-13" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="473" y="404" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="QTVUR145h4MCUghPp-7F-13" value="&lt;b&gt;人员门禁卡进行授权&lt;/b&gt;&lt;div&gt;前面绑定的卡是无授权开不了门的&lt;/div&gt;&lt;div&gt;需要在这里对卡片进行授权或批量授权&lt;/div&gt;&lt;div&gt;&lt;u&gt;授权之后才可以使用门禁卡进行开门等操作&lt;/u&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="763" y="369" width="246" height="70" as="geometry" />
        </mxCell>
        <mxCell id="QTVUR145h4MCUghPp-7F-22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="QTVUR145h4MCUghPp-7F-19" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="359" y="606" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="QTVUR145h4MCUghPp-7F-19" value="&lt;b&gt;门禁管理-授权任务详情&lt;/b&gt;&lt;div&gt;门禁权限中进行门禁卡授权后&lt;/div&gt;&lt;div&gt;授权记录会流转至授权任务详情&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="266" y="376.5" width="186" height="55" as="geometry" />
        </mxCell>
        <mxCell id="QTVUR145h4MCUghPp-7F-21" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="QTVUR145h4MCUghPp-7F-20" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="626" y="406" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="QTVUR145h4MCUghPp-7F-20" value="撤销授权也是&lt;div&gt;授权的就是门设备&lt;/div&gt;&lt;div&gt;即&lt;u&gt;在门禁管理-门禁概览中&lt;/u&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="550" y="441" width="154" height="60" as="geometry" />
        </mxCell>
        <mxCell id="QTVUR145h4MCUghPp-7F-26" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="QTVUR145h4MCUghPp-7F-23" target="QTVUR145h4MCUghPp-7F-25" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="QTVUR145h4MCUghPp-7F-27" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="QTVUR145h4MCUghPp-7F-23" target="QTVUR145h4MCUghPp-7F-25" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xoEWcCWnXlmrb0ALaJxB-2" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="QTVUR145h4MCUghPp-7F-23" target="xoEWcCWnXlmrb0ALaJxB-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="QTVUR145h4MCUghPp-7F-23" value="&lt;b&gt;门禁管理-门禁概览&lt;/b&gt;&lt;div&gt;这里可以实现开门、获取时间等操作&lt;/div&gt;&lt;div&gt;具体有没有关联到门禁卡？&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="254" y="618" width="210" height="55" as="geometry" />
        </mxCell>
        <mxCell id="QTVUR145h4MCUghPp-7F-35" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="QTVUR145h4MCUghPp-7F-25" target="QTVUR145h4MCUghPp-7F-34" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="QTVUR145h4MCUghPp-7F-25" value="&lt;b&gt;门禁管理-门禁操作明细&lt;/b&gt;&lt;div&gt;即门禁概览中门操作的记录都会流转进来&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="529" y="584" width="234" height="41" as="geometry" />
        </mxCell>
        <mxCell id="QTVUR145h4MCUghPp-7F-28" value="&lt;b&gt;门禁管理-门禁事件报表&lt;/b&gt;&lt;div&gt;每个持卡人操作的事件记录&lt;/div&gt;&lt;div&gt;开门、有效、无效等多种情况记录&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="545" y="697" width="198" height="55" as="geometry" />
        </mxCell>
        <mxCell id="QTVUR145h4MCUghPp-7F-34" value="&lt;b&gt;门禁管理-门禁操作分析&lt;/b&gt;&lt;div&gt;即操作门禁的情况（远程开门等）-成功失败&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="835" y="584" width="250" height="41" as="geometry" />
        </mxCell>
        <mxCell id="QTVUR145h4MCUghPp-7F-37" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.51;entryY=-0.109;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="QTVUR145h4MCUghPp-7F-25" target="QTVUR145h4MCUghPp-7F-28" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xoEWcCWnXlmrb0ALaJxB-1" value="&lt;b&gt;门禁管理-门禁管理配置&lt;/b&gt;&lt;div&gt;门禁概览展示的门禁信息都是在这里配置&lt;/div&gt;&lt;div&gt;配置之后会同步到动环监控中&lt;/div&gt;&lt;div&gt;即实时监控下面&lt;/div&gt;&lt;div&gt;同步到动环设备表中（93类型）&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="3" y="604" width="234" height="84" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="tcq5oO8bmvSmtskGEP3J" name="具体业务分析">
    <mxGraphModel dx="1426" dy="849" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="6estPEaWDlJmkfycUyNN-4" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="6estPEaWDlJmkfycUyNN-2" target="6estPEaWDlJmkfycUyNN-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6estPEaWDlJmkfycUyNN-2" value="1、新增门禁配置 - &amp;gt; 同步至动环设备（展示监控视图）&lt;div&gt;access_control_device的device_type = 2的设备&lt;/div&gt;&lt;div&gt;可以根据device_id实时在t_cfg_device表中查询&lt;/div&gt;&lt;div&gt;涉及服务：entrance-service&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="48" y="39" width="310" height="70" as="geometry" />
        </mxCell>
        <mxCell id="6estPEaWDlJmkfycUyNN-3" value="&lt;div&gt;-- nacos 配置非透传模版ID，device.default.modelId: 00001008000000003572&lt;/div&gt;&lt;div&gt;-- 1、在门禁配置管理新增门禁设备，验证设备信息同步到动环t_cfg_device&lt;/div&gt;&lt;div&gt;-- 2、验证综合监控视图门禁设备信息和实时数据正常&lt;/div&gt;&lt;div&gt;-- 3、门禁配置管理删除门禁设备，验证设备信息同步删除动环t_cfg_device对应门禁设备&lt;/div&gt;&lt;div&gt;-- 非透传门禁设备&lt;/div&gt;&lt;div&gt;select * from t_cfg_device where device_type = 93 and&amp;nbsp; access_type != 3;&lt;/div&gt;&lt;div&gt;SELECT * FROM access_control_device WHERE device_type = 2 ORDER BY time desc;&lt;/div&gt;&lt;div&gt;SELECT * FROM t_cfg_device WHERE precinct_id = &#39;01-01-23-03-06-01-06&#39; and device_type = 93;&lt;/div&gt;&lt;div&gt;SELECT * FROM t_cfg_metemodel_detail WHERE model_id = &#39;00001008000000003572&#39;&lt;/div&gt;&lt;div&gt;SELECT * FROM t_cfg_device where device_model = &#39;00001008000000003572&#39;;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;SELECT * FROM t_cfg_precinct where precinct_id like CONCAT(&#39;01-01-23-03-06&#39;,&#39;%&#39;,&#39;06&#39;)&lt;/div&gt;" style="whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="38" y="202" width="543" height="207" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="VLJNMXE8roDTVjz3cfdl" name="数据模拟流转">
    <mxGraphModel dx="1426" dy="849" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="kvutGJf6tKyTXD3bO7xy-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="kvutGJf6tKyTXD3bO7xy-2" target="kvutGJf6tKyTXD3bO7xy-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kvutGJf6tKyTXD3bO7xy-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="kvutGJf6tKyTXD3bO7xy-2" target="kvutGJf6tKyTXD3bO7xy-8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kvutGJf6tKyTXD3bO7xy-2" value="门禁管理-门禁配置管理" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="64" y="402" width="142" height="26" as="geometry" />
        </mxCell>
        <mxCell id="kvutGJf6tKyTXD3bO7xy-4" value="新增门禁模拟器" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="188" y="321" width="102" height="26" as="geometry" />
        </mxCell>
        <mxCell id="kvutGJf6tKyTXD3bO7xy-6" value="IP地址-port&lt;div&gt;为iot-test-门禁模拟器&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="386" y="261" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="kvutGJf6tKyTXD3bO7xy-8" value="center服务" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="386" y="525" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="kvutGJf6tKyTXD3bO7xy-10" value="模拟器与服务器&lt;div&gt;联通&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="188" y="476" width="102" height="41" as="geometry" />
        </mxCell>
        <mxCell id="kvutGJf6tKyTXD3bO7xy-11" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;服务部署说明&lt;/h1&gt;&lt;p&gt;iot-center与iot-decoder部署&lt;/p&gt;&lt;p&gt;iot-decoder的部署，需要先拉iot-center镜像启动（再通过docker cp进行替换包）&lt;/p&gt;&lt;p&gt;服务之间，还有模拟器与服务器之间需要开启白名单&lt;/p&gt;&lt;p&gt;注意有个前提条件：门禁管理-门禁配置管理，新增门禁配置后会生成一个控制器和控制器下的门设备对应的测试门ip要设置成跟模拟器服务器一样的ip，接入服务器可以悬着142的center1196的center2，端口port要设置成与开启的模拟器一样的端口（查看模拟器里面的配置文件，config）&lt;/p&gt;" style="text;html=1;whiteSpace=wrap;overflow=hidden;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="61" y="39" width="975" height="160" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="oloxe07HjBx-uNpLxokf" name="其他内容">
    <mxGraphModel dx="1426" dy="849" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <UserObject label="&lt;p style=&quot;box-sizing: border-box; margin-top: 0px !important; margin-right: 0px; margin-bottom: 16px; margin-left: 0px; color: rgb(51, 51, 51); font-family: &amp;quot;Microsoft YaHei&amp;quot;, Helvetica, &amp;quot;Meiryo UI&amp;quot;, &amp;quot;Malgun Gothic&amp;quot;, &amp;quot;Segoe UI&amp;quot;, &amp;quot;Trebuchet MS&amp;quot;, Monaco, monospace, Tahoma, STXihei, 华文细黑, STHeiti, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;wenquanyi micro hei&amp;quot;, FreeSans, Arimo, Arial, SimSun, 宋体, Heiti, 黑体, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;服务：entrance-service、iot-decoder、iot-center 后面两个涉关脚本（不用特别关注）&lt;br style=&quot;box-sizing: border-box;&quot;&gt;批量授权测试方法：&lt;br style=&quot;box-sizing: border-box;&quot;&gt;1.在服务器10.12.5.142 /opt 目录下copy iot-test脚本&lt;br style=&quot;box-sizing: border-box;&quot;&gt;2.修改配置文件config.josn 的port端口号（改为没有被占用的）&lt;br style=&quot;box-sizing: border-box;&quot;&gt;3.门禁配置管理 新增数据 ip需写对应服务器的地址 端口写对应iot-test脚本的port&lt;br style=&quot;box-sizing: border-box;&quot;&gt;4.新增数据时要注意：ip要在这个表（t_cfg_fsu ）查到，t_cfg_fsu 查到的数据对应的 device_id能在device 表查到数据并且device_code 不能为空。&lt;br style=&quot;box-sizing: border-box;&quot;&gt;第四点已经做好的了 不用重复去做&lt;br style=&quot;box-sizing: border-box;&quot;&gt;查询sql：SELECT * FROM t_cfg_device WHERE device_id = (SELECT device_id FROM t_cfg_fsu WHERE address = ‘对应门禁配的ip’) and device_code is not null&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box; margin: 0px 0px 16px; color: rgb(51, 51, 51); font-family: &amp;quot;Microsoft YaHei&amp;quot;, Helvetica, &amp;quot;Meiryo UI&amp;quot;, &amp;quot;Malgun Gothic&amp;quot;, &amp;quot;Segoe UI&amp;quot;, &amp;quot;Trebuchet MS&amp;quot;, Monaco, monospace, Tahoma, STXihei, 华文细黑, STHeiti, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;wenquanyi micro hei&amp;quot;, FreeSans, Arimo, Arial, SimSun, 宋体, Heiti, 黑体, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;5.新增数据后，门禁设备表能查到数据 access_control_device&lt;br style=&quot;box-sizing: border-box;&quot;&gt;6.门禁设备配置管理页面的增删改导入将实时同步至动环设备表，并可体现在监控视图&lt;br style=&quot;box-sizing: border-box;&quot;&gt;并且会同步给-&amp;gt; t_cfg_device device_id 表 对应的device_type = 2&lt;br style=&quot;box-sizing: border-box;&quot;&gt;7.配置新增完数据后，到门禁权限菜单-找到protest2 用来测试的 新增授权，批量勾选&lt;br style=&quot;box-sizing: border-box;&quot;&gt;确定后，在门禁授权详情会生成执行日志数据 看授权是否成功&lt;br style=&quot;box-sizing: border-box;&quot;&gt;7.新增人员 然后绑卡 然后给卡授权 然后执行各种门的操作&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box; margin: 0px 0px 16px; color: rgb(51, 51, 51); font-family: &amp;quot;Microsoft YaHei&amp;quot;, Helvetica, &amp;quot;Meiryo UI&amp;quot;, &amp;quot;Malgun Gothic&amp;quot;, &amp;quot;Segoe UI&amp;quot;, &amp;quot;Trebuchet MS&amp;quot;, Monaco, monospace, Tahoma, STXihei, 华文细黑, STHeiti, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;wenquanyi micro hei&amp;quot;, FreeSans, Arimo, Arial, SimSun, 宋体, Heiti, 黑体, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;8.用非法卡刷卡后 会产生事件生成告警&lt;br style=&quot;box-sizing: border-box;&quot;&gt;告警表alert_alerts 历史告警表 alert_alerts_his&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box; margin: 0px 0px 16px; color: rgb(51, 51, 51); font-family: &amp;quot;Microsoft YaHei&amp;quot;, Helvetica, &amp;quot;Meiryo UI&amp;quot;, &amp;quot;Malgun Gothic&amp;quot;, &amp;quot;Segoe UI&amp;quot;, &amp;quot;Trebuchet MS&amp;quot;, Monaco, monospace, Tahoma, STXihei, 华文细黑, STHeiti, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;wenquanyi micro hei&amp;quot;, FreeSans, Arimo, Arial, SimSun, 宋体, Heiti, 黑体, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;entrance_card_auth_task 门禁授权记录表&lt;br style=&quot;box-sizing: border-box;&quot;&gt;access_control_device 门禁设备表&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box; margin: 0px 0px 16px; color: rgb(51, 51, 51); font-family: &amp;quot;Microsoft YaHei&amp;quot;, Helvetica, &amp;quot;Meiryo UI&amp;quot;, &amp;quot;Malgun Gothic&amp;quot;, &amp;quot;Segoe UI&amp;quot;, &amp;quot;Trebuchet MS&amp;quot;, Monaco, monospace, Tahoma, STXihei, 华文细黑, STHeiti, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;wenquanyi micro hei&amp;quot;, FreeSans, Arimo, Arial, SimSun, 宋体, Heiti, 黑体, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;单个启动命令：nohup ./start.sh &amp;gt; upd_server1.out &amp;amp;&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box; margin: 0px 0px 16px; color: rgb(51, 51, 51); font-family: &amp;quot;Microsoft YaHei&amp;quot;, Helvetica, &amp;quot;Meiryo UI&amp;quot;, &amp;quot;Malgun Gothic&amp;quot;, &amp;quot;Segoe UI&amp;quot;, &amp;quot;Trebuchet MS&amp;quot;, Monaco, monospace, Tahoma, STXihei, 华文细黑, STHeiti, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;wenquanyi micro hei&amp;quot;, FreeSans, Arimo, Arial, SimSun, 宋体, Heiti, 黑体, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;批量开启服务器里面的py3脚本 start.sh 命令如下：&lt;br style=&quot;box-sizing: border-box;&quot;&gt;for dir in /opt/*/; do&lt;br style=&quot;box-sizing: border-box;&quot;&gt;if [ -f “$dir/start.sh” ]; then&lt;br style=&quot;box-sizing: border-box;&quot;&gt;cd “$dir” &amp;amp;&amp;amp; nohup ./start.sh &amp;gt; “$(basename “$dir”).out” 2&amp;gt;&amp;amp;1 &amp;amp;&lt;br style=&quot;box-sizing: border-box;&quot;&gt;fi&lt;br style=&quot;box-sizing: border-box;&quot;&gt;done&lt;br style=&quot;box-sizing: border-box;&quot;&gt;启动后lsof -i：配置文件的端口号 看服务是否启动成功&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box; margin: 0px 0px 16px; color: rgb(51, 51, 51); font-family: &amp;quot;Microsoft YaHei&amp;quot;, Helvetica, &amp;quot;Meiryo UI&amp;quot;, &amp;quot;Malgun Gothic&amp;quot;, &amp;quot;Segoe UI&amp;quot;, &amp;quot;Trebuchet MS&amp;quot;, Monaco, monospace, Tahoma, STXihei, 华文细黑, STHeiti, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;wenquanyi micro hei&amp;quot;, FreeSans, Arimo, Arial, SimSun, 宋体, Heiti, 黑体, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;二、&lt;br style=&quot;box-sizing: border-box;&quot;&gt;富力中心43楼真机：ip：192.168.0.2 port：20071&lt;br style=&quot;box-sizing: border-box;&quot;&gt;改配置时 需要改具体控制器下门的配置信息 不要单独改门的上级控制器的信息&lt;br style=&quot;box-sizing: border-box;&quot;&gt;因为控制器是虚拟设备，不参与指令（两个同步改）&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box; margin-top: 0px; margin-right: 0px; margin-bottom: 0px !important; margin-left: 0px; color: rgb(51, 51, 51); font-family: &amp;quot;Microsoft YaHei&amp;quot;, Helvetica, &amp;quot;Meiryo UI&amp;quot;, &amp;quot;Malgun Gothic&amp;quot;, &amp;quot;Segoe UI&amp;quot;, &amp;quot;Trebuchet MS&amp;quot;, Monaco, monospace, Tahoma, STXihei, 华文细黑, STHeiti, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;wenquanyi micro hei&amp;quot;, FreeSans, Arimo, Arial, SimSun, 宋体, Heiti, 黑体, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;测TCP门禁功能流程（真机）：若是用模拟器则不需测刷卡&lt;br style=&quot;box-sizing: border-box;&quot;&gt;读取事件 远程开门 通过事件生成告警 通过读取门状态生成消警 设置门禁时钟 读取门禁时钟 卡片授权 卡片撤权&lt;br style=&quot;box-sizing: border-box;&quot;&gt;用例如下：&lt;/p&gt;" link="&lt;p style=&quot;box-sizing: border-box; margin-top: 0px !important; margin-right: 0px; margin-bottom: 16px; margin-left: 0px; color: rgb(51, 51, 51); font-family: &amp;quot;Microsoft YaHei&amp;quot;, Helvetica, &amp;quot;Meiryo UI&amp;quot;, &amp;quot;Malgun Gothic&amp;quot;, &amp;quot;Segoe UI&amp;quot;, &amp;quot;Trebuchet MS&amp;quot;, Monaco, monospace, Tahoma, STXihei, 华文细黑, STHeiti, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;wenquanyi micro hei&amp;quot;, FreeSans, Arimo, Arial, SimSun, 宋体, Heiti, 黑体, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;服务：entrance-service、iot-decoder、iot-center 后面两个涉关脚本（不用特别关注）&lt;br style=&quot;box-sizing: border-box;&quot;&gt;批量授权测试方法：&lt;br style=&quot;box-sizing: border-box;&quot;&gt;1.在服务器10.12.5.142 /opt 目录下copy iot-test脚本&lt;br style=&quot;box-sizing: border-box;&quot;&gt;2.修改配置文件config.josn 的port端口号（改为没有被占用的）&lt;br style=&quot;box-sizing: border-box;&quot;&gt;3.门禁配置管理 新增数据 ip需写对应服务器的地址 端口写对应iot-test脚本的port&lt;br style=&quot;box-sizing: border-box;&quot;&gt;4.新增数据时要注意：ip要在这个表（t_cfg_fsu ）查到，t_cfg_fsu 查到的数据对应的 device_id能在device 表查到数据并且device_code 不能为空。&lt;br style=&quot;box-sizing: border-box;&quot;&gt;第四点已经做好的了 不用重复去做&lt;br style=&quot;box-sizing: border-box;&quot;&gt;查询sql：SELECT * FROM t_cfg_device WHERE device_id = (SELECT device_id FROM t_cfg_fsu WHERE address = ‘对应门禁配的ip’) and device_code is not null&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box; margin: 0px 0px 16px; color: rgb(51, 51, 51); font-family: &amp;quot;Microsoft YaHei&amp;quot;, Helvetica, &amp;quot;Meiryo UI&amp;quot;, &amp;quot;Malgun Gothic&amp;quot;, &amp;quot;Segoe UI&amp;quot;, &amp;quot;Trebuchet MS&amp;quot;, Monaco, monospace, Tahoma, STXihei, 华文细黑, STHeiti, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;wenquanyi micro hei&amp;quot;, FreeSans, Arimo, Arial, SimSun, 宋体, Heiti, 黑体, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;5.新增数据后，门禁设备表能查到数据 access_control_device&lt;br style=&quot;box-sizing: border-box;&quot;&gt;6.门禁设备配置管理页面的增删改导入将实时同步至动环设备表，并可体现在监控视图&lt;br style=&quot;box-sizing: border-box;&quot;&gt;并且会同步给-&amp;gt; t_cfg_device device_id 表 对应的device_type = 2&lt;br style=&quot;box-sizing: border-box;&quot;&gt;7.配置新增完数据后，到门禁权限菜单-找到protest2 用来测试的 新增授权，批量勾选&lt;br style=&quot;box-sizing: border-box;&quot;&gt;确定后，在门禁授权详情会生成执行日志数据 看授权是否成功&lt;br style=&quot;box-sizing: border-box;&quot;&gt;7.新增人员 然后绑卡 然后给卡授权 然后执行各种门的操作&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box; margin: 0px 0px 16px; color: rgb(51, 51, 51); font-family: &amp;quot;Microsoft YaHei&amp;quot;, Helvetica, &amp;quot;Meiryo UI&amp;quot;, &amp;quot;Malgun Gothic&amp;quot;, &amp;quot;Segoe UI&amp;quot;, &amp;quot;Trebuchet MS&amp;quot;, Monaco, monospace, Tahoma, STXihei, 华文细黑, STHeiti, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;wenquanyi micro hei&amp;quot;, FreeSans, Arimo, Arial, SimSun, 宋体, Heiti, 黑体, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;8.用非法卡刷卡后 会产生事件生成告警&lt;br style=&quot;box-sizing: border-box;&quot;&gt;告警表alert_alerts 历史告警表 alert_alerts_his&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box; margin: 0px 0px 16px; color: rgb(51, 51, 51); font-family: &amp;quot;Microsoft YaHei&amp;quot;, Helvetica, &amp;quot;Meiryo UI&amp;quot;, &amp;quot;Malgun Gothic&amp;quot;, &amp;quot;Segoe UI&amp;quot;, &amp;quot;Trebuchet MS&amp;quot;, Monaco, monospace, Tahoma, STXihei, 华文细黑, STHeiti, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;wenquanyi micro hei&amp;quot;, FreeSans, Arimo, Arial, SimSun, 宋体, Heiti, 黑体, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;entrance_card_auth_task 门禁授权记录表&lt;br style=&quot;box-sizing: border-box;&quot;&gt;access_control_device 门禁设备表&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box; margin: 0px 0px 16px; color: rgb(51, 51, 51); font-family: &amp;quot;Microsoft YaHei&amp;quot;, Helvetica, &amp;quot;Meiryo UI&amp;quot;, &amp;quot;Malgun Gothic&amp;quot;, &amp;quot;Segoe UI&amp;quot;, &amp;quot;Trebuchet MS&amp;quot;, Monaco, monospace, Tahoma, STXihei, 华文细黑, STHeiti, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;wenquanyi micro hei&amp;quot;, FreeSans, Arimo, Arial, SimSun, 宋体, Heiti, 黑体, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;单个启动命令：nohup ./start.sh &amp;gt; upd_server1.out &amp;amp;&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box; margin: 0px 0px 16px; color: rgb(51, 51, 51); font-family: &amp;quot;Microsoft YaHei&amp;quot;, Helvetica, &amp;quot;Meiryo UI&amp;quot;, &amp;quot;Malgun Gothic&amp;quot;, &amp;quot;Segoe UI&amp;quot;, &amp;quot;Trebuchet MS&amp;quot;, Monaco, monospace, Tahoma, STXihei, 华文细黑, STHeiti, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;wenquanyi micro hei&amp;quot;, FreeSans, Arimo, Arial, SimSun, 宋体, Heiti, 黑体, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;批量开启服务器里面的py3脚本 start.sh 命令如下：&lt;br style=&quot;box-sizing: border-box;&quot;&gt;for dir in /opt/*/; do&lt;br style=&quot;box-sizing: border-box;&quot;&gt;if [ -f “$dir/start.sh” ]; then&lt;br style=&quot;box-sizing: border-box;&quot;&gt;cd “$dir” &amp;amp;&amp;amp; nohup ./start.sh &amp;gt; “$(basename “$dir”).out” 2&amp;gt;&amp;amp;1 &amp;amp;&lt;br style=&quot;box-sizing: border-box;&quot;&gt;fi&lt;br style=&quot;box-sizing: border-box;&quot;&gt;done&lt;br style=&quot;box-sizing: border-box;&quot;&gt;启动后lsof -i：配置文件的端口号 看服务是否启动成功&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box; margin: 0px 0px 16px; color: rgb(51, 51, 51); font-family: &amp;quot;Microsoft YaHei&amp;quot;, Helvetica, &amp;quot;Meiryo UI&amp;quot;, &amp;quot;Malgun Gothic&amp;quot;, &amp;quot;Segoe UI&amp;quot;, &amp;quot;Trebuchet MS&amp;quot;, Monaco, monospace, Tahoma, STXihei, 华文细黑, STHeiti, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;wenquanyi micro hei&amp;quot;, FreeSans, Arimo, Arial, SimSun, 宋体, Heiti, 黑体, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;二、&lt;br style=&quot;box-sizing: border-box;&quot;&gt;富力中心43楼真机：ip：192.168.0.2 port：20071&lt;br style=&quot;box-sizing: border-box;&quot;&gt;改配置时 需要改具体控制器下门的配置信息 不要单独改门的上级控制器的信息&lt;br style=&quot;box-sizing: border-box;&quot;&gt;因为控制器是虚拟设备，不参与指令（两个同步改）&lt;/p&gt;&lt;p style=&quot;box-sizing: border-box; margin-top: 0px; margin-right: 0px; margin-bottom: 0px !important; margin-left: 0px; color: rgb(51, 51, 51); font-family: &amp;quot;Microsoft YaHei&amp;quot;, Helvetica, &amp;quot;Meiryo UI&amp;quot;, &amp;quot;Malgun Gothic&amp;quot;, &amp;quot;Segoe UI&amp;quot;, &amp;quot;Trebuchet MS&amp;quot;, Monaco, monospace, Tahoma, STXihei, 华文细黑, STHeiti, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;Droid Sans&amp;quot;, &amp;quot;wenquanyi micro hei&amp;quot;, FreeSans, Arimo, Arial, SimSun, 宋体, Heiti, 黑体, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;测TCP门禁功能流程（真机）：若是用模拟器则不需测刷卡&lt;br style=&quot;box-sizing: border-box;&quot;&gt;读取事件 远程开门 通过事件生成告警 通过读取门状态生成消警 设置门禁时钟 读取门禁时钟 卡片授权 卡片撤权&lt;br style=&quot;box-sizing: border-box;&quot;&gt;用例如下：&lt;/p&gt;" id="T85CL4I__FMC5siGVAHM-1">
          <mxCell style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
            <mxGeometry x="162" y="14" width="854" height="806" as="geometry" />
          </mxCell>
        </UserObject>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
