# 待解决疑问

- 实时监控中为什么有些机房下设备是没有测点的呢
  - 解答：因为站点下没有配置对应机房，或是机房下没有配置对应设备

# 01_403错误【网关白名单】--重点

- 请求是特殊字段校验出错 - 即403字符错误类【配置特殊字符白名单, 在 gateway中配置连接】
- 根据环境情况，到nacos进去对应环境【哪个省份或是集团】
  - 搜索 -- > application-gateway.yaml 【网关配置】
  - 在aspire下whiteList下配置请求失败的接口 -> 即可解决这个问题
  - 是否加字符串就根据已有的来判断


# 02_问题定位能力

- 页面请求出现错误时，需要会排查时哪个服务器出现的问题【即那个微服务出现问题 - 例如一个功能模块会对应一个服务】，因此需要有功能服务对应理解
- 同时还要注意当前系统有多个环境，每个环节也都有微服务【因此需要先确认是在哪个平台的，到nacos找到对应平台 - 里面记录了各服务的ip等信息】
- 如果已经知道对应关系【直接在cicd中搜索对应的项目和服务名 - 建议进到rancher里面查看 - 在页面检测不出问题是，也可以在这里看日志】
- 开发修改后git【这边要自己到cicd流水线中找到对应服务进行打包部署】
- 某些功能的数据生成是会用到定时器等工具才能触发
  - 【需要跟开发说，问清楚，一般是使用crul在对应服务器中触发，如果是在本地那么就不能写localhost】
  - 必须修改对应服务的ip和post
- 然后目前接触的几个项目都是B接口项目【即sc系统直接跟FSU设备数据交互 - 需要用到es插入的数据】
- 造数方面【还需继续深入了解】
  - 目前都是往es插入数据进行造数
  - 还有FSU模拟造数
  - 还有B接口模拟造数
  - 还有C接口模拟造数

# 03_服务器日志定位【后台】

- **后端的  -->  CICD**
  - **流水线中 -- 搜索流水线名字 -- composite --> 这个都是后端的**
    - 里面有标明是云南，广东，集团，内蒙等后台日志
      - 然后里面又有很多各容器，放各种功能【最终都会输出到对应的这个日志中，因为这个服务是由多个微服务组成的】



# 04_测试多思维

- **一般实时数据校验**
  - 根据机房或机柜下配置设备对应测点：【根据测点编码和设备】在【综合-监控视图】或【综合监控-监控视图】中去查看
- **一般历史数据校验**
  - 上海sc：
    - 【报表管理-性能数据报表】 -- 【只要造了历史数据的都可以在该表下查看到】
    - 或者看对应的his类历史表，因为es中间库会同步到mysql中
  - 集团：
    - pass
- **数据校验**
  - 一般都可以直接在页面中找到对应的校验内容【例如A数据是由B页面数据而来】
  - 也可以结合数据库【但是需要知道是哪个表 - 以及计算的关系】
  - 还要注意是否涉及到中间件等信息



# 05_条件查询类型

- 首先时页面从第一个参数，到最后一个参数，检测每次请求的接口参数是否正确 -- 然后判断相应结果
- 接着验证跟页面是否一致
- 如果有计算逻辑需要校验数据准确性



# 06_区分前后端

- 首先了解后端服务所对应的服务名有哪些【因为公司是微服务架构】
  - 后台查看日志【后台：指在服务器中查看服务器日志】
    - 然后到cicd中查看对应后端服务
    - 查看日志情况【在页面发请求或接口层面发请求时--关注接口是否到日志中 - 来判断前后端】
  - 注意点：
    - 页面上的链接是前端的，f12里面则是组成这个连接用到的多个后端接口【可以直接用post对这些后端接口测试】
    - 这样就是绕过前端，不用让前端帮我们做请求，我们自己去请求



# 07_C接口【实时数据】

- **涉及表**
  - t_cfg_cserverinfo：C接口【监控实时数据关联配置对应表】  --> 在spider数据库中查看
    - **疑问点：**
      - 为什么看到的csvrip和csvrip有点不太一样呢【表中和nacos中搜索出来的】
        - 好像是要看lsc_id，接入段要一致 -- 然后csvrip和csvrip只是提供服务的路径

      - 然后又in，out又是什么意思
      - 还有服务器nohup，看它怎么插入【即对应csvrip服务器里面的日志吗】

    - **表结构**
      - 主要记录监控id【即区域点，lsc_id很重要】，对应的c接口服务服务ip，c接口服务端口
      - dog用户和用户名
      - 数据库类型，数据库服务ip和端口，数据库名
      - 设备id 【关乎设备对应测点的推送】
      - protocol -- 对应350协议和400协议
      - read_node--read服务节点编码、tcp_node、schedule_node

  - t_cfg_metemodel、t_cfg_metemodel_detail --> 实时数据推送过来的会没有测点编码，C接口推送【模拟的】的则有
    - 表结构

- **推送流程**
  - C接口模拟造数【以报文形式推送kafka】 -- 然后会分拣数据 -- redis或是其他
    - 会实时展示redis，然后还会落库到中间件中【也是在t_cfg_cserverinfo表中就可查看】


# 08_B接口【实时数据】

- 

# 09_各环境数据来源

- 集团数据来源
  - 集团的底层数据从C接口开的【C接口当作一个数据来源】

# 10_B接口操作

- 

# 11_C接口操作

- 此模拟器模拟了C接口V3.5版本的第三方数据库（mysql），以及对应的socket接口（登录、心跳、以及实时监控）
- **构建模拟器的第三方库**
  - 

# 12_B接口fsu测点新增

- 新增测点，无法显示问题
- 如果是告警的不会显示
- 解决方法
  - 现在t_cfg_mete里面加上这个测点记录
  - 然后到nacos看config的服务列表配置在那个服务器【一般只有一个的，有两个先下线一个】
  - 然后根据那个ip，到虚拟机里面，查看对应config的容器服务，进行重启
  - 然后到fsu模拟器，重新上报
  - 上报完成，在t_cfg_metemodel_detail看是否加载进来，进来就可以了

# 13_验收测试注意

- 记得多来回切换测试下
- 第一轮测完后，每个地方都点一点
- 验证完后，相关的点也再点一点
- 注意每次下载这些都不要忘了测
- 多切换才知道有没有反应慢之类的问题
- 主要看的点
  - 字段、缓存、来回切换的反应，多次刷新等情况下
  - 数据检验

# 14_403无权限问题

- 原先是由后端控制的，但是现在是由前端控制
  - 控制是通过url与xml做绑定
    - 即系统管理-机构角色管理，里面来做判断
  - 如果是没有权限的话，就是找前端，然后把对应的url给到前端，让前端做绑定

# 15_用电关系里面没有显示测点信息

注意：这个很重要

- 问题1：
  - 可能是机房未接入设备，并未接入相关测点【即未接入fsu和sc】
- 问题2：
  - 可能是没有选择对应机房
  - 每次进来之后需要先选择机房才会展示
- 问题3：
  - 可能进来后，选择了机房，但是页面上选的是关键测点、开发在制作时并未列出关键测点
  - 需要选择为全量测点
- 问题4：
  - 可能选择了某个类型，只展示了某个类型的
