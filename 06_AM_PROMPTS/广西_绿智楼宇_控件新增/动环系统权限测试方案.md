# 动环系统权限测试方案

```
其实只需要考虑
	高权限：全部数据权限，控制按钮
	低权限：部分数据权限，全部控制按钮
	无权限：没数据权限，控制按钮
	
	其他
		有数据权限，但是没有按钮
```



## 1. 系统概述

动环系统是广西省用于监控机房、基站等场景的核心技术体系，主要功能包括动力监测、环境监测、系统日志、告警管理等。本次新增了四个功能tab，每个tab页面都有新增、查看、导出、导入功能，需要进行前端权限限制和测试验证。

## 2. 功能模块定义

绿智楼宇系统新增的四个功能页面为：

| 页面名称 | 功能描述 |
|---------|----------|
| 楼宇基础信息维护 | 维护楼宇的基本信息，支持新增、查询、导出、编辑、删除、导入等功能 |
| 电表基础信息维护 | 维护电表的基本信息，支持新增、查询、导出、编辑、删除、导入等功能 |
| 电表日用电量 | 展示电表的日用电量数据，支持查询、导出功能，报表自动生成 |
| 楼宇其他能源消耗量 | 维护楼宇其他能源消耗信息，支持新增、查询、导出、查看、编辑、删除、导入等功能 |

## 3. 权限设计

### 3.1 角色定义

| 角色名称 | 权限范围 |
|---------|----------|
| 超级管理员 | 所有功能权限，可访问所有地市数据 |
| 系统管理员 | 所有功能权限，可访问所有地市数据，但无系统配置权限 |
| 数据维护员 | 所有功能权限，但仅可访问指定地市数据 |
| 只读用户 | 仅查看、导出权限，无新增、导入、编辑、删除权限，可访问所有地市数据 |
| 受限用户 | 仅新增、导入权限，无查看、导出、编辑、删除权限，仅可访问指定地市数据 |

### 3.2 权限矩阵

| 角色 | 功能 | 楼宇基础信息维护 | 电表基础信息维护 | 电表日用电量 | 楼宇其他能源消耗量 |
|------|------|------------------|------------------|--------------|--------------------|
| 超级管理员 | 新增 | √ | √ | - | √ |
| | 查看 | √ | √ | √ | √ |
| | 导出 | √ | √ | √ | √ |
| | 导入 | √ | √ | - | √ |
| | 编辑 | √ | √ | - | √ |
| | 删除 | √ | √ | - | √ |
| 系统管理员 | 新增 | √ | √ | - | √ |
| | 查看 | √ | √ | √ | √ |
| | 导出 | √ | √ | √ | √ |
| | 导入 | √ | √ | - | √ |
| | 编辑 | √ | √ | - | √ |
| | 删除 | √ | √ | - | √ |
| 数据维护员 | 新增 | √ | √ | - | √ |
| | 查看 | √ | √ | √ | √ |
| | 导出 | √ | √ | √ | √ |
| | 导入 | √ | √ | - | √ |
| | 编辑 | √ | √ | - | √ |
| | 删除 | √ | √ | - | √ |
| 只读用户 | 新增 | × | × | - | × |
| | 查看 | √ | √ | √ | √ |
| | 导出 | √ | √ | √ | √ |
| | 导入 | × | × | - | × |
| | 编辑 | × | × | - | × |
| | 删除 | × | × | - | × |
| 受限用户 | 新增 | √ | √ | - | √ |
| | 查看 | × | × | × | × |
| | 导出 | × | × | × | × |
| | 导入 | √ | √ | - | √ |
| | 编辑 | × | × | - | × |
| | 删除 | × | × | - | × |

## 4. 账号构建方案

### 4.1 账号列表

| 账号名称 | 角色 | 密码 | 所属地区 | 可访问地市 |
|---------|------|------|----------|------------|
| hjj001 | 超级管理员 | Admin123 | 广西省 | 所有地市 |
| hjj002 | 系统管理员 | Sysadmin123 | 广西省 | 所有地市 |
| hjj003 | 数据维护员 | Datamgr123 | 广西省 | 百色市 |
| hjj004 | 数据维护员 | Datamgr123 | 广西省 | 桂林市 |
| hjj005 | 只读用户 | Readonly123 | 广西省 | 所有地市 |
| hjj006 | 受限用户 | Limited123 | 广西省 | 百色市 |
| hjj007 | 受限用户 | Limited123 | 广西省 | 桂林市 |

### 4.2 账号创建步骤

1. 登录系统管理后台
2. 进入用户管理模块
3. 点击"新增用户"按钮
4. 填写用户信息（用户名、密码、角色、所属地区等）
5. 点击"保存"按钮
6. 重复步骤3-5，创建所有测试账号

## 5. 测试用例设计

### 5.1 功能测试用例

#### 5.1.1 新增功能测试

| 测试用例ID | 测试功能 | 测试步骤 | 预期结果 | 测试账号 |
|------------|----------|----------|----------|----------|
| TC-001 | 楼宇基础信息维护-新增 | 1. 使用admin账号登录系统<br>2. 进入楼宇基础信息维护页面<br>3. 点击"新增"按钮<br>4. 填写新增表单<br>5. 点击"保存"按钮 | 新增成功，数据显示在列表中 | admin |
| TC-002 | 电表基础信息维护-新增 | 1. 使用admin账号登录系统<br>2. 进入电表基础信息维护页面<br>3. 点击"新增"按钮<br>4. 填写新增表单<br>5. 点击"保存"按钮 | 新增成功，数据显示在列表中 | admin |
| TC-003 | 楼宇其他能源消耗量-新增 | 1. 使用admin账号登录系统<br>2. 进入楼宇其他能源消耗量页面<br>3. 点击"新增"按钮<br>4. 填写新增表单<br>5. 点击"保存"按钮 | 新增成功，数据显示在列表中 | admin |

#### 5.1.2 查看功能测试

| 测试用例ID | 测试功能 | 测试步骤 | 预期结果 | 测试账号 |
|------------|----------|----------|----------|----------|
| TC-004 | 楼宇基础信息维护-查看 | 1. 使用admin账号登录系统<br>2. 进入楼宇基础信息维护页面<br>3. 点击列表中某条数据的"查看"按钮 | 显示数据详情 | admin |
| TC-005 | 电表基础信息维护-查看 | 1. 使用admin账号登录系统<br>2. 进入电表基础信息维护页面<br>3. 点击列表中某条数据的"查看"按钮 | 显示数据详情 | admin |
| TC-006 | 电表日用电量-查看 | 1. 使用admin账号登录系统<br>2. 进入电表日用电量页面<br>3. 设置查询条件<br>4. 点击"查询"按钮 | 显示符合条件的电表日用电量数据 | admin |
| TC-007 | 楼宇其他能源消耗量-查看 | 1. 使用admin账号登录系统<br>2. 进入楼宇其他能源消耗量页面<br>3. 点击列表中某条数据的"查看"按钮 | 显示数据详情 | admin |

#### 5.1.3 导出功能测试

| 测试用例ID | 测试功能 | 测试步骤 | 预期结果 | 测试账号 |
|------------|----------|----------|----------|----------|
| TC-008 | 楼宇基础信息维护-导出 | 1. 使用admin账号登录系统<br>2. 进入楼宇基础信息维护页面<br>3. 点击"导出"按钮<br>4. 选择导出格式<br>5. 点击"确认"按钮 | 导出成功，下载文件包含所有数据 | admin |
| TC-009 | 电表基础信息维护-导出 | 1. 使用admin账号登录系统<br>2. 进入电表基础信息维护页面<br>3. 点击"导出"按钮<br>4. 选择导出格式<br>5. 点击"确认"按钮 | 导出成功，下载文件包含所有数据 | admin |
| TC-010 | 电表日用电量-导出 | 1. 使用admin账号登录系统<br>2. 进入电表日用电量页面<br>3. 设置查询条件<br>4. 点击"导出"按钮<br>5. 选择导出格式<br>6. 点击"确认"按钮 | 导出成功，下载文件包含符合条件的数据 | admin |
| TC-011 | 楼宇其他能源消耗量-导出 | 1. 使用admin账号登录系统<br>2. 进入楼宇其他能源消耗量页面<br>3. 点击"导出"按钮<br>4. 选择导出格式<br>5. 点击"确认"按钮 | 导出成功，下载文件包含所有数据 | admin |

#### 5.1.4 导入功能测试

| 测试用例ID | 测试功能 | 测试步骤 | 预期结果 | 测试账号 |
|------------|----------|----------|----------|----------|
| TC-012 | 楼宇基础信息维护-导入 | 1. 使用admin账号登录系统<br>2. 进入楼宇基础信息维护页面<br>3. 点击"导入"按钮<br>4. 选择导入文件<br>5. 点击"确认"按钮 | 导入成功，数据显示在列表中 | admin |
| TC-013 | 电表基础信息维护-导入 | 1. 使用admin账号登录系统<br>2. 进入电表基础信息维护页面<br>3. 点击"导入"按钮<br>4. 选择导入文件<br>5. 点击"确认"按钮 | 导入成功，数据显示在列表中 | admin |
| TC-014 | 楼宇其他能源消耗量-导入 | 1. 使用admin账号登录系统<br>2. 进入楼宇其他能源消耗量页面<br>3. 点击"导入"按钮<br>4. 选择导入文件<br>5. 点击"确认"按钮 | 导入成功，数据显示在列表中 | admin |

#### 5.1.5 编辑功能测试

| 测试用例ID | 测试功能 | 测试步骤 | 预期结果 | 测试账号 |
|------------|----------|----------|----------|----------|
| TC-015 | 楼宇基础信息维护-编辑 | 1. 使用admin账号登录系统<br>2. 进入楼宇基础信息维护页面<br>3. 点击列表中某条数据的"编辑"按钮<br>4. 修改表单数据<br>5. 点击"保存"按钮 | 编辑成功，数据已更新 | admin |
| TC-016 | 电表基础信息维护-编辑 | 1. 使用admin账号登录系统<br>2. 进入电表基础信息维护页面<br>3. 点击列表中某条数据的"编辑"按钮<br>4. 修改表单数据<br>5. 点击"保存"按钮 | 编辑成功，数据已更新 | admin |
| TC-017 | 楼宇其他能源消耗量-编辑 | 1. 使用admin账号登录系统<br>2. 进入楼宇其他能源消耗量页面<br>3. 点击列表中某条数据的"编辑"按钮<br>4. 修改表单数据<br>5. 点击"保存"按钮 | 编辑成功，数据已更新 | admin |

#### 5.1.6 删除功能测试

| 测试用例ID | 测试功能 | 测试步骤 | 预期结果 | 测试账号 |
|------------|----------|----------|----------|----------|
| TC-018 | 楼宇基础信息维护-删除 | 1. 使用admin账号登录系统<br>2. 进入楼宇基础信息维护页面<br>3. 勾选一条或多条数据<br>4. 点击"删除"按钮<br>5. 在确认对话框中点击"确认"按钮 | 删除成功，数据从列表中移除 | admin |
| TC-019 | 电表基础信息维护-删除 | 1. 使用admin账号登录系统<br>2. 进入电表基础信息维护页面<br>3. 勾选一条或多条数据<br>4. 点击"删除"按钮<br>5. 在确认对话框中点击"确认"按钮 | 删除成功，数据从列表中移除 | admin |
| TC-020 | 楼宇其他能源消耗量-删除 | 1. 使用admin账号登录系统<br>2. 进入楼宇其他能源消耗量页面<br>3. 勾选一条或多条数据<br>4. 点击"删除"按钮<br>5. 在确认对话框中点击"确认"按钮 | 删除成功，数据从列表中移除 | admin |

### 5.2 权限测试用例

#### 5.2.1 超级管理员权限测试

| 测试用例ID | 测试功能 | 测试步骤 | 预期结果 | 测试账号 |
|------------|----------|----------|----------|----------|
| TC-021 | 超级管理员-所有功能 | 1. 使用admin账号登录系统<br>2. 依次进入四个功能页面<br>3. 验证新增、查看、导出、导入、编辑、删除按钮是否可见且可用 | 所有按钮可见且可用 | admin |

#### 5.2.2 系统管理员权限测试

| 测试用例ID | 测试功能 | 测试步骤 | 预期结果 | 测试账号 |
|------------|----------|----------|----------|----------|
| TC-022 | 系统管理员-所有功能 | 1. 使用sysadmin账号登录系统<br>2. 依次进入四个功能页面<br>3. 验证新增、查看、导出、导入、编辑、删除按钮是否可见且可用 | 所有按钮可见且可用 | sysadmin |

#### 5.2.3 数据维护员权限测试

| 测试用例ID | 测试功能 | 测试步骤 | 预期结果 | 测试账号 |
|------------|----------|----------|----------|----------|
| TC-023 | 数据维护员-楼宇基础信息维护 | 1. 使用datamgr_nn账号登录系统<br>2. 进入楼宇基础信息维护页面<br>3. 验证新增、查看、导出、导入、编辑、删除按钮状态 | 所有按钮可见且可用 | datamgr_nn |
| TC-024 | 数据维护员-数据权限验证 | 1. 使用datamgr_nn账号登录系统<br>2. 进入楼宇基础信息维护页面<br>3. 查询所有地市数据<br>4. 验证是否只能看到南宁市数据 | 只能看到南宁市数据，无法看到其他地市数据 | datamgr_nn |

#### 5.2.4 只读用户权限测试

| 测试用例ID | 测试功能 | 测试步骤 | 预期结果 | 测试账号 |
|------------|----------|----------|----------|----------|
| TC-025 | 只读用户-楼宇基础信息维护 | 1. 使用readonly账号登录系统<br>2. 进入楼宇基础信息维护页面<br>3. 验证新增、查看、导出、导入、编辑、删除按钮状态 | 仅查看、导出按钮可见且可用，其他按钮不可见或不可用 | readonly |
| TC-026 | 只读用户-电表基础信息维护 | 1. 使用readonly账号登录系统<br>2. 进入电表基础信息维护页面<br>3. 验证新增、查看、导出、导入、编辑、删除按钮状态 | 仅查看、导出按钮可见且可用，其他按钮不可见或不可用 | readonly |

#### 5.2.5 受限用户权限测试

| 测试用例ID | 测试功能 | 测试步骤 | 预期结果 | 测试账号 |
|------------|----------|----------|----------|----------|
| TC-027 | 受限用户-楼宇基础信息维护 | 1. 使用limited_nn账号登录系统<br>2. 进入楼宇基础信息维护页面<br>3. 验证新增、查看、导出、导入、编辑、删除按钮状态 | 仅新增、导入按钮可见且可用，其他按钮不可见或不可用 | limited_nn |
| TC-028 | 受限用户-楼宇其他能源消耗量 | 1. 使用limited_nn账号登录系统<br>2. 进入楼宇其他能源消耗量页面<br>3. 验证新增、查看、导出、导入、编辑、删除按钮状态 | 仅新增、导入按钮可见且可用，其他按钮不可见或不可用 | limited_nn |
| TC-029 | 受限用户-数据权限验证 | 1. 使用limited_nn账号登录系统<br>2. 进入电表基础信息维护页面<br>3. 查询所有地市数据<br>4. 验证是否只能看到南宁市数据 | 只能看到南宁市数据，无法看到其他地市数据 | limited_nn |
| TC-030 | 受限用户-无法查看数据验证 | 1. 使用limited_nn账号登录系统<br>2. 进入楼宇基础信息维护页面<br>3. 尝试查看列表中的数据详情<br>4. 验证是否无法查看数据 | 无法查看数据详情，系统提示无权限 | limited_nn |
| TC-031 | 受限用户-无法查看电表日用电量 | 1. 使用limited_nn账号登录系统<br>2. 尝试进入电表日用电量页面<br>3. 验证是否无法查看电表日用电量数据 | 无法查看电表日用电量数据，系统提示无权限 | limited_nn |

### 5.3 边界测试用例

| 测试用例ID | 测试功能 | 测试步骤 | 预期结果 | 测试账号 |
|------------|----------|----------|----------|----------|
| TC-043 | 无权限访问 | 1. 使用无任何权限的账号登录系统<br>2. 尝试访问四个功能页面 | 无法访问，系统提示无权限 | 无权限账号 |
| TC-044 | 权限变更测试 | 1. 使用admin账号登录系统<br>2. 修改operator账号的角色为报表分析师<br>3. 使用operator账号重新登录系统<br>4. 验证权限是否已更新 | 权限已更新为报表分析师权限 | admin, operator |
| TC-045 | 多角色测试 | 1. 为某个账号分配多个角色<br>2. 登录系统验证权限 | 权限为多个角色的并集 | 多角色账号 |
| TC-046 | 电表日用电量无新增功能测试 | 1. 使用admin账号登录系统<br>2. 进入电表日用电量页面<br>3. 验证是否存在新增、导入、编辑、删除按钮 | 无新增、导入、编辑、删除按钮，仅显示查看、导出按钮 | admin |

### 5.4 接口越权测试用例

#### 5.4.1 纵向越权测试（低权限角色访问高权限功能）

| 测试用例ID | 测试功能 | 测试步骤 | 预期结果 | 测试账号 |
|------------|----------|----------|----------|----------|
| TC-047 | 只读用户越权新增楼宇基础信息 | 1. 使用readonly账号登录系统，获取token<br>2. 使用接口测试工具调用楼宇基础信息维护新增接口<br>3. 携带readonly的token发送请求 | 接口返回403 Forbidden或权限不足错误 | readonly |
| TC-048 | 只读用户越权删除电表基础信息 | 1. 使用readonly账号登录系统，获取token<br>2. 使用接口测试工具调用电表基础信息维护删除接口<br>3. 携带readonly的token发送请求 | 接口返回403 Forbidden或权限不足错误 | readonly |
| TC-049 | 受限用户越权查看电表日用电量 | 1. 使用limited_nn账号登录系统，获取token<br>2. 使用接口测试工具调用电表日用电量查看接口<br>3. 携带limited_nn的token发送请求 | 接口返回403 Forbidden或权限不足错误 | limited_nn |
| TC-050 | 受限用户越权导出楼宇基础信息 | 1. 使用limited_nn账号登录系统，获取token<br>2. 使用接口测试工具调用楼宇基础信息维护导出接口<br>3. 携带limited_nn的token发送请求 | 接口返回403 Forbidden或权限不足错误 | limited_nn |
| TC-051 | 受限用户越权查看楼宇基础信息 | 1. 使用limited_nn账号登录系统，获取token<br>2. 使用接口测试工具调用楼宇基础信息维护查看接口<br>3. 携带limited_nn的token发送请求 | 接口返回403 Forbidden或权限不足错误 | limited_nn |
| TC-052 | 受限用户越权查看楼宇其他能源消耗量 | 1. 使用limited_nn账号登录系统，获取token<br>2. 使用接口测试工具调用楼宇其他能源消耗量查看接口<br>3. 携带limited_nn的token发送请求 | 接口返回403 Forbidden或权限不足错误 | limited_nn |
| TC-053 | 受限用户越权编辑电表基础信息 | 1. 使用limited_nn账号登录系统，获取token<br>2. 使用接口测试工具调用电表基础信息维护编辑接口<br>3. 携带limited_nn的token发送请求 | 接口返回403 Forbidden或权限不足错误 | limited_nn |
| TC-054 | 受限用户越权删除楼宇其他能源消耗量 | 1. 使用limited_nn账号登录系统，获取token<br>2. 使用接口测试工具调用楼宇其他能源消耗量删除接口<br>3. 携带limited_nn的token发送请求 | 接口返回403 Forbidden或权限不足错误 | limited_nn |

#### 5.4.2 数据权限越权测试（跨地市数据访问）

| 测试用例ID | 测试功能 | 测试步骤 | 预期结果 | 测试账号 |
|------------|----------|----------|----------|----------|
| TC-055 | 数据维护员跨地市访问数据 | 1. 使用datamgr_nn账号登录系统，获取token<br>2. 使用接口测试工具调用查看接口，携带datamgr_nn的token和柳州市数据ID<br>3. 发送请求 | 接口返回403 Forbidden或无权限访问该数据 | datamgr_nn |
| TC-056 | 受限用户跨地市访问数据 | 1. 使用limited_nn账号登录系统，获取token<br>2. 使用接口测试工具调用查看接口，携带limited_nn的token和柳州市数据ID<br>3. 发送请求 | 接口返回403 Forbidden或无权限访问该数据 | limited_nn |

#### 5.4.3 功能权限越权测试（按钮权限验证）

| 测试用例ID | 测试功能 | 测试步骤 | 预期结果 | 测试账号 |
|------------|----------|----------|----------|----------|
| TC-057 | 按钮权限验证-新增功能 | 1. 使用不同角色账号登录系统<br>2. 查看各角色对新增按钮的权限<br>3. 验证权限配置是否与预期一致 | 仅超级管理员、系统管理员、数据维护员、受限用户可使用新增功能 | 各角色账号 |
| TC-058 | 按钮权限验证-导出功能 | 1. 使用不同角色账号登录系统<br>2. 查看各角色对导出按钮的权限<br>3. 验证权限配置是否与预期一致 | 仅超级管理员、系统管理员、数据维护员、只读用户可使用导出功能 | 各角色账号 |
| TC-059 | 按钮权限验证-查看功能 | 1. 使用不同角色账号登录系统<br>2. 查看各角色对查看按钮的权限<br>3. 验证权限配置是否与预期一致 | 仅超级管理员、系统管理员、数据维护员、只读用户可使用查看功能 | 各角色账号 |
| TC-060 | 按钮权限验证-编辑功能 | 1. 使用不同角色账号登录系统<br>2. 查看各角色对编辑按钮的权限<br>3. 验证权限配置是否与预期一致 | 仅超级管理员、系统管理员、数据维护员可使用编辑功能 | 各角色账号 |
| TC-061 | 按钮权限验证-删除功能 | 1. 使用不同角色账号登录系统<br>2. 查看各角色对删除按钮的权限<br>3. 验证权限配置是否与预期一致 | 仅超级管理员、系统管理员、数据维护员可使用删除功能 | 各角色账号 |

## 6. 数据验证方法

### 6.1 验证点

1. **前端按钮可见性**：验证不同角色登录后，各功能按钮是否按照权限设置显示或隐藏
2. **前端按钮可用性**：验证不同角色登录后，各功能按钮是否按照权限设置可用或不可用
3. **功能操作权限**：验证不同角色登录后，是否能够成功执行对应的功能操作
4. **数据访问权限**：验证不同角色登录后，是否只能访问授权范围内的数据
5. **权限变更即时性**：验证权限变更后，是否立即生效
6. **接口层面权限验证**：
   - 验证无权限角色调用接口时返回403 Forbidden
   - 验证低权限角色无法调用高权限功能接口
   - 验证同级别角色无法访问其他角色的数据
   - 验证跨模块权限控制是否生效
7. **越权访问验证**：
   - 验证横向越权（同级别角色访问其他角色数据）是否被阻止
   - 验证纵向越权（低级别角色访问高级别功能）是否被阻止
   - 验证跨模块越权访问是否被阻止

### 6.2 验证工具

1. **浏览器开发者工具**：用于查看前端按钮的DOM结构和样式，验证按钮是否可见
2. **接口测试工具**：用于测试后端API的权限控制（如Postman、JMeter等）
3. **数据库查询工具**：用于验证数据是否正确存储和访问
4. **抓包工具**：用于捕获和分析HTTP请求，验证权限控制机制
5. **日志分析工具**：用于查看系统日志，验证权限相关的操作记录

### 6.3 接口权限验证步骤

1. **获取测试账号凭证**：
   - 使用不同角色的账号登录系统，获取有效的token或session
   - 记录每个角色的凭证信息

2. **接口调用验证**：
   - 使用接口测试工具构造请求，携带不同角色的凭证
   - 调用目标接口（新增、查看、导出、导入）
   - 记录接口返回结果

3. **越权测试验证**：
   - 横向越权：使用A角色凭证调用B角色数据的接口
   - 纵向越权：使用低权限角色凭证调用高权限功能接口
   - 跨模块越权：使用角色A凭证调用非授权模块的接口

4. **结果验证**：
   - 验证有权限的角色能够成功调用接口
   - 验证无权限的角色调用接口返回403 Forbidden或其他权限错误
   - 验证跨角色数据访问被正确阻止
   - 验证跨模块访问被正确阻止

### 6.4 数据有效性验证

1. **新增功能验证**：
   - 验证有新增权限的角色能够成功新增数据
   - 验证新增的数据能够正确存储到数据库
   - 验证无新增权限的角色无法新增数据

2. **查看功能验证**：
   - 验证有查看权限的角色能够成功查看授权范围内的数据
   - 验证无查看权限的角色无法查看数据
   - 验证同级别角色只能查看自己的数据

3. **导出功能验证**：
   - 验证有导出权限的角色能够成功导出数据
   - 验证导出的数据包含授权范围内的所有数据
   - 验证无导出权限的角色无法导出数据

4. **导入功能验证**：
   - 验证有导入权限的角色能够成功导入数据
   - 验证导入的数据能够正确存储到数据库
   - 验证无导入权限的角色无法导入数据

## 7. 测试执行流程

1. **准备阶段**：
   - 创建测试账号：按照4.1节的账号列表创建所有测试账号
   - 准备测试数据：准备各功能模块的测试数据，包括导入数据模板
   - 配置测试环境：确保测试环境与生产环境配置一致
   - 准备测试工具：安装并配置接口测试工具、抓包工具等

2. **执行阶段**：
   
   ### 2.1 前端功能验证测试
   - 按照5.1节功能测试用例执行，验证各功能模块的新增、查看、导出、导入功能是否正常工作
   - 使用超级管理员账号执行所有功能，确保基础功能正常
   - 记录功能测试结果

   ### 2.2 前端权限验证测试
   - 按照5.2节权限测试用例执行，验证不同角色登录系统后，前端按钮的可见性和可用性
   - 依次使用各角色账号登录，验证各功能模块的按钮状态
   - 记录前端权限测试结果

   ### 2.3 接口功能验证测试
   - 使用接口测试工具，按照5.1节功能测试用例的功能点，测试各接口是否正常工作
   - 验证接口返回数据格式是否正确
   - 验证接口响应时间是否符合要求
   - 记录接口功能测试结果

   ### 2.4 接口越权测试
   - 按照5.4节接口越权测试用例执行，验证接口层面的权限控制
   - 执行纵向越权测试：低权限角色调用高权限功能接口
   - 执行横向越权测试：同级别角色访问其他角色数据
   - 执行跨模块越权测试：角色访问非授权模块接口
   - 使用抓包工具监控接口请求和响应
   - 记录接口越权测试结果

   ### 2.5 边界条件测试
   - 按照5.3节边界测试用例执行，验证边界条件下的权限控制
   - 执行无权限访问测试
   - 执行权限变更测试
   - 执行多角色测试
   - 记录边界测试结果

3. **分析阶段**：
   - 分析测试结果：统计测试通过率，分析失败原因
   - 编写测试报告：包括测试概述、测试结果、失败用例详情、测试结论等
   - 提出改进建议：针对测试中发现的问题，提出改进建议
   - 重点分析越权测试结果，确保所有越权访问都被正确阻止

4. **验证阶段**：
   - 针对测试中发现的问题，跟踪修复情况
   - 对修复后的问题进行回归测试
   - 验证权限控制机制是否完善
   - 确保所有权限问题都已解决

## 8. 测试报告模板

### 8.1 测试概述

| 测试项目 | 动环系统权限测试 |
|----------|------------------|
| 测试时间 | YYYY-MM-DD |
| 测试人员 | 测试工程师姓名 |
| 测试环境 | 测试环境名称 |
| 测试版本 | 系统版本号 |

### 8.2 测试结果统计

| 测试类型 | 测试用例数 | 通过数 | 失败数 | 通过率 |
|----------|------------|--------|--------|--------|
| 功能测试 | 20 | 20 | 0 | 100% |
| 权限测试 | 11 | 11 | 0 | 100% |
| 边界测试 | 4 | 4 | 0 | 100% |
| 接口越权测试 | 15 | 15 | 0 | 100% |
| 合计 | 50 | 50 | 0 | 100% |

### 8.3 失败用例详情

| 测试用例ID | 测试功能 | 失败原因 | 解决方案 |
|------------|----------|----------|----------|
| - | - | - | - |

### 8.4 测试结论

1. 动环系统的权限控制功能符合设计要求
2. 所有测试用例均通过，系统稳定性良好
3. 建议在生产环境中继续监控权限控制功能的运行情况

## 9. 风险评估

| 风险项 | 风险等级 | 风险描述 | 应对措施 |
|--------|----------|----------|----------|
| 权限设计不合理 | 高 | 权限设计过于复杂或过于简单，导致权限控制失效 | 仔细设计权限矩阵，充分测试各类角色的权限 |
| 前端权限控制被绕过 | 中 | 用户通过修改前端代码绕过权限控制 | 同时在后端实现权限控制，前端仅作为辅助 |
| 权限变更不及时 | 低 | 权限变更后，用户需要重新登录才能生效 | 优化权限变更机制，实现实时生效 |

## 10. 优化建议

1. 建议在系统中添加权限审计功能，记录用户的权限变更和操作记录
2. 建议实现基于资源的细粒度权限控制，提高系统的安全性
3. 建议定期进行权限审查，及时清理不必要的权限
4. 建议为不同角色提供个性化的系统界面，提高用户体验

## 11. 附录

### 11.1 测试数据模板

#### 楼宇基础信息维护数据模板

| 地市名称 | 建筑ID | 楼宇名称 | 站点名称 |
|----------|--------|----------|----------|
| 南宁市 | BLD001 | 绿智大厦 | 南宁中心站点 |
| 柳州市 | BLD002 | 智慧广场 | 柳州中心站点 |
| 桂林市 | BLD003 | 科技大楼 | 桂林中心站点 |

#### 电表基础信息维护数据模板

| 地市名称 | 站点名称 | 楼宇名称 | 电表ID | 建筑ID | 采集点位类型 | 数据上传方式 | 安装类型 |
|----------|----------|----------|--------|--------|--------------|--------------|----------|
| 南宁市 | 南宁中心站点 | 绿智大厦 | MTR001 | BLD001 | 智能电表 | 4G | 室内 |
| 柳州市 | 柳州中心站点 | 智慧广场 | MTR002 | BLD002 | 智能电表 | 有线 | 室内 |
| 桂林市 | 桂林中心站点 | 科技大楼 | MTR003 | BLD003 | 智能电表 | 4G | 室外 |

#### 电表日用电量数据模板

| 电表ID | 抄表日期 | 日用电量(kWh) |
|--------|----------|---------------|
| MTR001 | 2023-01-01 | 150.5 |
| MTR001 | 2023-01-02 | 145.8 |
| MTR002 | 2023-01-01 | 200.2 |
| MTR002 | 2023-01-02 | 195.3 |
| MTR003 | 2023-01-01 | 120.7 |
| MTR003 | 2023-01-02 | 118.9 |

#### 楼宇其他能源消耗量数据模板

| 建筑ID | 地市名称 | 楼宇名称 | 抄表月份 | 水消耗量(t) | 燃气消耗量(m³) | 其他能源类型 | 其他能源消耗量 |
|--------|----------|----------|----------|--------------|----------------|--------------|----------------|
| BLD001 | 南宁市 | 绿智大厦 | 2023-01 | 500.2 | 300.5 | 热力 | 200.8 |
| BLD002 | 柳州市 | 智慧广场 | 2023-01 | 600.1 | 350.3 | 热力 | 250.6 |
| BLD003 | 桂林市 | 科技大楼 | 2023-01 | 450.8 | 280.7 | 热力 | 180.4 |

### 11.2 测试账号模板

| 账号名称 | 角色 | 密码 | 所属地区 | 创建时间 |
|---------|------|------|----------|----------|
| test001 | 超级管理员 | Test001123 | 广西省 | 2023-01-01 |
| test002 | 系统管理员 | Test002123 | 广西省 | 2023-01-01 |
| test003 | 运维人员 | Test003123 | 广西省 | 2023-01-01 |
| test004 | 数据录入员 | Test004123 | 广西省 | 2023-01-01 |
| test005 | 报表分析师 | Test005123 | 广西省 | 2023-01-01 |

---

**测试方案编制人**：测试工程师
**测试方案审核人**：系统架构师
**测试方案批准人**：项目经理
**测试方案编制日期**：2023-01-01
**测试方案生效日期**：2023-01-02