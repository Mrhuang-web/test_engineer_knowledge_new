# 01总结

```
涉及服务
	前端、composite-service、scada-service

涉及脚本（脚本已在测试环境运行）
        https://gitsz1.aspirecn.com/spider/kernelGuangXi/-/blob/develop/spider-guangxi/bin/dbscript/GXEMS1.0.10.0/dml/%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91%E5%AD%97%E5%85%B8%E6%B7%BB%E5%8A%A0_dml_20251023.sql?ref_type=heads
        https://gitsz1.aspirecn.com/spider/kernelGuangXi/-/blob/develop/spider-guangxi/bin/dbscript/GXEMS1.0.10.0/ddl/%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91%E9%85%8D%E7%BD%AE_ddl_20251023.sql?ref_type=heads
```



```
# 相关配置表
	SELECT * FROM t_cfg_topology_configuration;
	SELECT * FROM t_cfg_topology_config_part;
	SELECT * FROM t_cfg_topology_config;
```



```
业务说明：
	站点和机房维度才可以绘制拓扑（且ip需要都限制 - 如果非专业则不限制）
		拖拽配置，配置的确认只是暂存（需要点击页面左上角保存画布 - 才会入库数据库），如果没有保存数据会丢失
	省市区展示
		省 - 展示跨市拓扑（也就是不同市里面不同站点）
		市 - 展示跨区拓扑（也就是不同区里面不同站点）
		区 - 展示跨站点拓扑（也就是不同站点里面配置上下级关系）
	上下级关系关联
		可以先创建，后面再指定上下游
		可以通过ip指定上下游
		可以通过拖拽指定上下游
```



# 02补充

```
前端
		1、全选有问题（无法圈中），快捷键无法全选，只能选一个 【目前取消了这个功能】
		2、取消按钮，无法取消
		3、确认后弹窗不关闭
		4、必填项删除后提示变英文【每一项都要检查】
		5、撤销快捷键（改为一次撤销，不用多次）
		6、其他工具未涉及
		7、重做快捷键无效
		8、未配置拓扑，地市区显示为空
		9、存在组件未填，画布提交应该做限制
		10、跨站点连线未区分颜色
		11、多机房、多站点【省份和地市和区县】只展示了第一条，缺失其他配置拓扑的信息
		12、圈选设备后，自动弹出设备详情，需要去除自动弹出
		13、画布校验【目前就按照后端校验，前端就只校验设备详情的内容，画布直接发出】
		14、工具栏，delete描述改删除
		15、连线时，兼容性要好一点
		16、重做（只能是对没有删除的内容进行下一步，也就是撤销后，可以返回过去）


		14、拖拽出来的设备【目前必须要先在设备详情里面保存成功，不然保存画布后，他还是会以最初的内容发送出去】  --- 后续可能要优化
后端：
		组件未填写时，直接保存画布，提示语优化
		1、目前没有考虑到站点类型的（比如筛选站点类型，拓扑只展示对应站点类型的拓扑）
		2、目前没有过滤掉没有上下游的
		
		3、上游设备ip未填写，后期再不上，好像还没做关联

		4、上游删除后，状态没有改，还是会展示，但实际上上游已经消除了  -- 需要编辑删除时，同时编辑所有的上游是该设备，且状态为跨站点的，全部都修改状态
			前端会根据后端接口返回的某个标识参数进行区分

		5、首次创建未指派上游设备（第二次编辑的时候就无法再判断是否跨站了） -- 需要增加编辑时，对ip进行判断上下游，修改状态



容器时的展示，才有点击机房进行下钻（现在是连线展示）
```



```
设备的保存（只是页面缓存保存）

顶部的保存才是正则发起请求

顶部的删除 - 把画布即设备一起删除
	delete只是删除设备



造数逻辑
	省
		市（2）
			区（2）
				站点（2）		
						10.2.1.1
						防火墙 (Firewall) - 核心路由器 (Core Router)-核心交换机 (Core Switch) 		
					机房（2）	10.1.1.1	
						负载均衡器（服务器群）    汇聚交换机（无线控制器 (WLC) ）
						个人电脑（工作站） - 摄像头（fsu） - NVR



好像
	地市区这个取的，是画布最后一次保存时操作的内容





逻辑？
	机房时（在拓扑时，是否展示连线？）
		就是从机房开始，建设组件 -- 组件会缓存在页面，最终以左上角保存才算提交
			提交时两个内容
				json画布内容  - 存画布表
				组件配置内容  - 存组件标
			提交后会返回
				json画布内容
				组件信息
					前端根据关联关系进行画线

	站点时（在拓扑时，是否需要展示连线？   -- 展示站点下每一个直接连接的ip即可？）
		多个机房
		站点也可以进行绘制 - 绘制的话可以作为机房的上游（这里是站点级维度）
			提交也是一样
			然后返回
				正常来说应该有多少个机房就返回多少个机房
	区点时




开发逻辑
	自动生成（getLowerTopologyConfigList?）
		注意：
			里面的所有是指每个站点或每个机房都有一张（如果是要上下级关联，那么会总和为１张）
			如果站点或机房里面，存在一些连接，一些未连接，那么就会分成两张出来了，返回就会返回两张了
			（所以只展示有关联的？）
			（ｅｇ：如果省下，两个市）
		点击省
			返回所有市
		点击市
			返回所有市
		点击区
			返回所有区
	画布生成（）


	跨站点问题
		只要不在同一级别就是　　　跨机房或是跨站点



逻辑补充
	1、原先没有写上游ip格式错误的，都需要先补充上去
	2、提交后由后端进行校验{前端暂时不做校验  -- 前端只在设备详情里面判断，画布提交不判断}

不足点
	1、画布保存，未填项目应该由前端判断（未填的不应该发起请求）
	2、目前修改后，不符合规则也可以显示保存成功（但是画布提交后端校验时不通过的，正常不符合在设备详情里面也不能保存）
```



```
1、只要存站点级别一下的
	因为 - 
		站点和站点以上都是自动生成的，站点下的是用户操作的
		站点以上【是站点之间的关系进行关联】
		站点以下都是全部丢到里面【即前端全部的东西都存在json里面 -- 后端不关注json，只是回显前端，所以只需要给前端】


	目前逻辑
		一个节点一个节点进行保存，【但是整张画布不保存，那么这些节点有什么用】
			一定要有组件才有json，没有组件也就没有对应json信息


		如果只保存一次
			那么就是每个节点都放在同一份json 

		
		如果每次拖动都保存
			那么每个节点都是一个json


		删除逻辑
			是一次删除一个画布
			还是一次只是一个节点，那么直接修改编辑就可以了


			删除是单个节点删除


	接口
		省市区

		站点以上：自动绘制的接口
		站点以下：手工绘制的接口



		字段：id和类型


	画布问题
		右边属性暂存，然后再一次保存全部
		一个暂存一个保存

		删除按钮
			删除某个原件【所选的原件】


	站点级别以上的自动绘制
		是否有类型
		区县
		地市
			只要程现，站点跟站点之间的关系即可
			区县
				比如说下面有10个站点，那么只需要显示这10个站点的关系【ip的关系，都是交换机】
					标注哪台机出去，哪个ip出去的	

	连接记录
		是有上游下游
			A连到B，B连到A是不同的【需要去区分上下游，录入的话呢，跨站点就连不了线】

			目前没有连线，就根据ip生成


		目前有两种形式
			1、根据连线
			2、根据ip生成
```







```
目前树结构机制：
	省
		市
			区
				站点 - 可绘制   -- 绘制的【如果有机房 - 只展示机房组件为站点- 即上游设备的那个组件】
					楼栋
						机房 - 可绘制 -- 绘制完整的网络拓扑
	存在问题：
		如果省市区不可绘制，那么怎么生成网址的网络拓扑



绘画机制：
	



ip机制：
	每个设备都有一个ip的
	



上下游机制：
	可以在机房层级，可以跨层级进行上游设备的配置
	

上下游配置关系：
	如果连线，怎么配置上下游关系
	


机房站点
	如何展示？
	如何自动关联？
	

ip库
	综资数据相关
	
专业是什么
	对应哪里的数据
	

树结构回显标识
	根据接口返回的字段来判断是否有要打勾
```

