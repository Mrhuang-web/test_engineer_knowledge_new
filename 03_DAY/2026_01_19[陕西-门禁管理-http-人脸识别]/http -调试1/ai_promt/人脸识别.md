### 核心结论
设备存储人员照片后的识别功能，核心体现在「识别记录相关接口」和「识别回调接口」中，通过设备本地识别、记录生成存储、回调通知（可选）三个环节实现。

### 一、功能体现位置
#### 1. 识别记录查询接口（5.1 识别记录查询）
- 接口作用：查询设备识别人员后生成的记录（含现场抓拍照片路径）。
- 关键说明：识别成功后，设备自动存储识别记录，包含活体判断、识别结果、现场照路径等信息，可通过该接口获取。

#### 2. 识别记录删除接口（5.2 识别记录删除）
- 接口作用：删除指定条件下的识别记录（含对应的现场抓拍照片）。
- 关键说明：仅当设备已生成识别记录时，该接口可执行删除操作，反向印证识别记录的存储功能。

#### 3. 识别回调接口（2.7 识别回调）
- 接口作用：设置回调地址后，设备识别成功会主动推送识别记录到该地址。
- 关键说明：回调数据包含现场照路径、识别时间、人员ID等信息，是识别功能的延伸通知机制。

#### 4. 接口调用流程（1.3 接口调用流程）
- 明确描述：设备成功存储人员照片后即可识别该人员，识别成功后产生含现场抓拍照片的识别记录并存储。

### 二、功能实现方式
#### 1. 识别触发条件
- 人员已完成注册（调用3.1 人员注册接口）。
- 该人员已添加注册照片（调用4.1 照片注册/4.5 拍照注册接口）。
- 满足识别模式要求（刷脸、人卡合一、人证比对等，通过卡片设置/人员权限配置）。

#### 2. 识别与记录生成流程
1. 设备通过摄像头采集人员现场图像，与存储的注册照片进行比对。
2. 比对成功（活体判断通过+人员信息匹配）后，设备自动生成识别记录。
3. 记录内容包含：时间戳、人员ID、现场抓拍照片路径、识别模式、活体结果等。
4. 记录存储在设备本地，支持通过「识别记录查询接口」导出。

#### 3. 可选：回调通知实现（若设置回调地址）
1. 调用2.7 识别回调接口，传入合法的callbackUrl。
2. 识别成功后，设备向回调地址POST识别数据（含现场照路径、人员信息等）。
3. 回调地址返回`{"result":1,"success":true}`后，设备标记记录状态为“回调成功”；失败则10分钟后重试。

#### 4. 现场抓拍照片访问方式
- 识别记录中返回`path`字段（如`ftp://192.168.18.17:8010/IdentifyRecords/2019-09-30/xxx.jpg`）。
- 访问要求：设备连网在线，且客户端与设备处于同一局域网网段。

### 三、核心接口详情（实现关键）
#### 1. 识别记录查询接口（获取识别结果）
- 请求方式：GET
- URL：`http://设备IP:8090/newFindRecords`
- 必传参数：
  - pass：设备密码
  - personId：人员ID（传入-1查询所有人员，STRANGERBABY查询陌生人）
  - startTime/endTime：查询时间范围（0表示不限制）
- 返回示例关键字段：
  ```json
  "data": {
    "records": [
      "path": "ftp://xxx/IdentifyRecords/xxx.jpg", // 现场抓拍照片路径
      "aliveType": 1, // 1=活体成功
      "identifyType": 1, // 1=识别成功
      "personId": "xxx", // 识别的人员ID
      "time": 1569827175865 // 识别时间戳
    ]
  }
  ```

#### 2. 识别回调接口（主动推送识别结果）
- 请求方式：POST
- URL：`http://设备IP:8090/setIdentifyCallBack`
- 必传参数：
  - pass：设备密码
  - callbackUrl：回调地址（符合正则格式）
- 回调数据示例（含现场照信息）：
  ```json
  {
    "deviceKey": "84E0F420893301FA",
    "path": "ftp://xxx/IdentifyRecords/xxx.jpg", // 现场抓拍照片路径
    "personId": "xxx",
    "time": "1573459122354",
    "type": "face_0" // 刷脸识别成功
  }
  ```

### 四、注意事项
1. 识别记录默认存储在设备本地，未设置回调时，记录状态直接标记为“成功”（state:1）。
2. 现场抓拍照片仅能通过识别记录中的`path`字段访问，无法单独下载，删除识别记录会同步删除对应照片。
3. 支持按人员ID、时间范围、识别模式等条件筛选查询识别记录。

要不要我帮你整理一份**识别功能核心接口调用示例（含参数模板）** ？