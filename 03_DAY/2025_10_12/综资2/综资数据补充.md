# 补充疑问

```
动环 与 综资 区域匹配？
动环 与 综资 站点匹配？
动环 与 综资 机房匹配？
动环 与 综资 设备匹配？
```



# 映射表

```
动环库
	asyn表里面
```



# 原始数据

```
补充：目前数据全是综资的


```



# 综资视图

```
补充：目前数据全是综资的

涉及文件：7、网络资源通用标准数据模型-动环v3.6-20240320-定稿
涉及索引：1、站点动环属性；2、空间-站点；3、站点映射；4、园区（数据中心）
小补充点：可以通过动环表 - 里面有对应的综资点（就比如precinct里面省份有对应综资的id）


左侧树
	getPrecinctTree接口【区域展示的是动环的东西好像】
		说明：下面说到的综资区域编码 - 即precinct表中的area_code用于去综资匹配的
		1、中国移动-省份-地市-区县【即区域展示】：通过动环id，获取下级动环区域id和综资区域编码
		2、中国移动层级的话，直接就是拿全部综资；如果是地区这种，需要用区域编码区过滤综资数据返回
		3、省份地市区县都是需要用编码过滤的【省份就省份编码，地市就需要省份+区域编码，依次类推】
	getSiteTree接口【站点等全部东西都是综资的】
		1、站点 - 通过返回的综资区域编码 到 综资筛选到对应站点【zh_label字段】
			【有两种方式匹配】
			方式1：
				1、然后综资那边又会通过zh_label对应到ods_zz_site里面的int_id，拿到zh_label站点名
				2、如果没有还可以通过related_dc到园区表去拿
			方式2：
				1、通过综资zh_label对应到映射表的zg_name，拿到对应站点名信息【如果没有就再拿到动环的】 
			
		
	
		

右侧内容
	report/zzData/getSitePropertyList
		1、默认就是展示全部综资数据
		2、如果点击左侧树结构具体树节点【只是展开没效果的】，则会过滤综资数据
		
		
区分小点：
	对应站点动环属性
	树目录中：站点用的zh_label【包含site_id】
	页面数据：站点用的zh_label:
```





# 超期服役

```
按站点级别统计进来【拿完之后放动环表了】 -- 拿之前的逻辑

根据动环id
	然后再根据
	
	
设备这一块：
	设备里面是由relate_room 和 site
```



# 设备生命周期

```
同步时候按站点进行同步

中国移动
	动环id - 返回综资编码
    省份
        动环id - 返回综资编码
        地市
            动环id - 返回综资编码
            区县
                综资区域id - 拿到该区域的站点信息
                

设备中
	relate_room和site  对应到  空间站点和空间机房的int_id(资源标识)
	
```





# 一、**动环与综资对象匹配**

## 对应关系

| 动环                    | 综资 | 模型         |
| ----------------------- | ---- | ------------ |
| 数据中心                | 园区 |              |
| 核心机楼+数据中心的楼栋 | 站点 | RM_AREA_SITE |

说明：核心站点、核心站点（配套），包含数据中心楼栋传输节点：骨干站点、汇聚站点通信基站：接入站点、用户站点



## **方案一、通过综资提供的动环映射表进行匹配**

| 序号 | 模型名称     | 文件名                                 |
| ---- | ------------ | -------------------------------------- |
| 1    | 园区映射关系 | IRMS_RM_DC_MAP-V1.0-D-批次号.CSV       |
| 2    | 站点映射关系 | IRMS_RM_BUILDING_MAP-V1.0-D-批次号.CSV |
| 3    | 机房映射关系 | IRMS_RM_ROOM_MAP-V1.0-D-批次号.CSV     |

### **1.** 数据中心园区映射关系：

通过综资空间提供的映射表

| 序号 | 字段中文名称     | 字段英文名称 | 说明   |
| ---- | ---------------- | ------------ | ------ |
| 1    | 记录id           | uuid         | 记录id |
| 1    | 部省数据中心ID   | zg_id        |        |
| 2    | 部省数据中心名称 | **zg_name**  |        |
| 3    | PMS系统园区ID    | pms_id       |        |
| 4    | PMS系统园区名称  | pms_name     |        |
| 5    | 动环园区ID       | dh_id        |        |
| 6    | 动环园区名称     | dh_name      |        |
| 7    | 数据时间         | batch_num    |        |

### **2.** 站点映射关系：

| 序号 | 字段英文名称    | 字段中文名称 | 说明   |
| ---- | --------------- | ------------ | ------ |
| 1    | 记录id          | uuid         | 记录id |
| 1    | 部省站点ID      | zg_id        |        |
| 2    | 部省站点名称    | zg_name      |        |
| 3    | PMS系统站点ID   | pms_id       |        |
| 4    | PMS系统站点名称 | pms_name     |        |
| 5    | 动环站点ID      | dh_id        |        |
| 6    | 动环站点名称    | dh_name      |        |
| 7    | 数据时间        | batch_num    |        |

### **3.** 机房映射关系：

| 序号 | 字段中文名称 | 字段英文名称 | 取值说明                                        |
| ---- | ------------ | ------------ | ----------------------------------------------- |
| 1    | 记录id       | uuid         | 记录id                                          |
| 2    | 部省机房ID   | zg_id        | **对应：RM_AREA_ROOM表“资源标识（int_id）**     |
| 3    | 部省机房名称 | zg_name      | **对应：RM_AREA_ROOM表“位置点名称（zh_label）** |
| 4    | PMS机房ID    | pms_id       | 对应部省上报中机房的PMS机房设计编码             |
| 5    | PMS机房名称  | pms_name     | 对应部省上报中机房的PMS机房设计名称             |
| 6    | 动环机房ID   | dh_id        |                                                 |
| 7    | 动环机房名称 | dh_name      |                                                 |
| 8    | 地点编码     | address_code | 来源部省上报中机房的地点编码                    |
| 9    | 数据时间     | batch_num    | 数据生成时间                                    |





## 方案二、通过对象名称匹配

**在方案一执行后，对于还有无法匹配的，采用方案二进行**

```
在动环平台主要分为：
	省、市、区、站点、楼栋、机房、设备。


因此与综资的匹配从省开始，逐级匹配。
	由于动环的区域信息，并不是完全符合全国最新的行政区划的标准名称
	所以实际的匹配过程中，区域配置，只需要，满足：省、市两级即可，区县的匹配忽略
```



**①区域匹配：满足、省、市匹配即可**

即：动环表中对应的区域编码

| 动环字段 | 综资字段名称 | 综资字段英文名称 | 综资表名              | 综资表                       |
| -------- | ------------ | ---------------- | --------------------- | ---------------------------- |
| 省       | 所属省份     | province_id      | 所有空间表+动环属性表 | 区域信息（区县及以上）字典表 |
| 市       | 所属地市     | city_id          |                       |                              |

**②数据中心匹配：在满足区域匹配的前提下，满足一下匹配**

| 动环字段         | 综资字段名称 | 综资字段英文名称 | 综资表名         | 综资表     |
| ---------------- | ------------ | ---------------- | ---------------- | ---------- |
| 站点（数据中心） | 数据中心名称 | zh_label         | 数据中心（空间） | RM_AREA_DC |

**③站点匹配：在满足区域匹配的前提下，满足一下匹配**

| 动环字段                   | 综资字段名称 | 综资字段英文名称 | 综资表名     | 综资表           |
| -------------------------- | ------------ | ---------------- | ------------ | ---------------- |
| 站点（核心机楼/汇聚/基站） | 站点名称     | zh_label         | 站点（空间） | RM_AREA_SITE     |
|                            | 站点名称     | zh_label         | 站点动环属性 | RM_SITE_PROPERTY |

**④楼栋匹配：在满足区域匹配的前提下，满足一下匹配**

| 动环字段 | 综资字段名称          | 综资字段英文名称    | 综资表名     | 综资表           |
| -------- | --------------------- | ------------------- | ------------ | ---------------- |
| 楼栋     | 站点名称 所属数据中心 | zh_label related_dc | 站点（空间） | RM_AREA_SITE     |
|          | 站点名称              | zh_label            | 站点动环属性 | RM_SITE_PROPERTY |

**④机房匹配：在满足①区域匹配，②站点匹配的前提下，满足一下匹配**

| 动环字段          | 综资字段名称                     | 综资字段英文名称      | 综资表名         | 综资表       |
| ----------------- | -------------------------------- | --------------------- | ---------------- | ------------ |
| 机房              | 机房名称 所属站点                | zh_label related_site | 机房（空间）     | RM_AREA_ROOM |
| 机房名称 所属站点 | zh_label power_related_site_name | 机房动环属性          | RM_ROOM_PROPERTY |              |
